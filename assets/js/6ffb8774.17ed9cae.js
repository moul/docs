"use strict";(self.webpackChunkosmosis_docs=self.webpackChunkosmosis_docs||[]).push([[2014],{3905:(e,n,t)=>{t.d(n,{Zo:()=>k,kt:()=>m});var o=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,o,a=function(e,n){if(null==e)return{};var t,o,a={},l=Object.keys(e);for(o=0;o<l.length;o++)t=l[o],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)t=l[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var s=o.createContext({}),c=function(e){var n=o.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},k=function(e){var n=c(e.components);return o.createElement(s.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},u=o.forwardRef((function(e,n){var t=e.components,a=e.mdxType,l=e.originalType,s=e.parentName,k=i(e,["components","mdxType","originalType","parentName"]),u=c(t),m=a,p=u["".concat(s,".").concat(m)]||u[m]||d[m]||l;return t?o.createElement(p,r(r({ref:n},k),{},{components:t})):o.createElement(p,r({ref:n},k))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var l=t.length,r=new Array(l);r[0]=u;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i.mdxType="string"==typeof e?e:a,r[1]=i;for(var c=2;c<l;c++)r[c]=t[c];return o.createElement.apply(null,r)}return o.createElement.apply(null,t)}u.displayName="MDXCreateElement"},25187:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>r,default:()=>d,frontMatter:()=>l,metadata:()=>i,toc:()=>c});var o=t(87462),a=(t(67294),t(3905));const l={},r="Lockup",i={unversionedId:"modules/lockup/README",id:"modules/lockup/README",title:"Lockup",description:"Abstract",source:"@site/docs/osmosis-core/modules/lockup/README.md",sourceDirName:"modules/lockup",slug:"/modules/lockup/",permalink:"/osmosis-core/modules/lockup/",draft:!1,editUrl:"https://github.com/osmosis-labs/docs/tree/main/docs/osmosis-core/modules/lockup/README.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Incentives",permalink:"/osmosis-core/modules/incentives/"},next:{title:"Mint",permalink:"/osmosis-core/modules/mint/"}},s={},c=[{value:"Abstract",id:"abstract",level:2},{value:"Contents",id:"contents",level:2},{value:"Concepts",id:"concepts",level:2},{value:"State",id:"state",level:2},{value:"Locked coins management",id:"locked-coins-management",level:3},{value:"Period Lock",id:"period-lock",level:3},{value:"Period lock reference queues",id:"period-lock-reference-queues",level:3},{value:"Synthetic Lockup",id:"synthetic-lockup",level:3},{value:"Synthetic lock reference queues",id:"synthetic-lock-reference-queues",level:3},{value:"Messages",id:"messages",level:2},{value:"Lock Tokens",id:"lock-tokens",level:3},{value:"Begin Unlock of all locks",id:"begin-unlock-of-all-locks",level:3},{value:"Begin unlock for a lock",id:"begin-unlock-for-a-lock",level:3},{value:"Events",id:"events",level:2},{value:"Handlers",id:"handlers",level:3},{value:"MsgLockTokens",id:"msglocktokens",level:4},{value:"MsgBeginUnlocking",id:"msgbeginunlocking",level:4},{value:"MsgBeginUnlockingAll",id:"msgbeginunlockingall",level:4},{value:"Endblocker",id:"endblocker",level:3},{value:"Automatic withdraw when unlock time mature",id:"automatic-withdraw-when-unlock-time-mature",level:4},{value:"Keepers",id:"keepers",level:2},{value:"Lockup Keeper",id:"lockup-keeper",level:3},{value:"Lock Admin Keeper",id:"lock-admin-keeper",level:3},{value:"Hooks",id:"hooks",level:2},{value:"Tokens Locked",id:"tokens-locked",level:3},{value:"Parameters",id:"parameters",level:2},{value:"Endblocker",id:"endblocker-1",level:2},{value:"Withdraw tokens after unlock time mature",id:"withdraw-tokens-after-unlock-time-mature",level:3},{value:"Remove synthetic locks after removal time mature",id:"remove-synthetic-locks-after-removal-time-mature",level:3},{value:"Transactions",id:"transactions",level:2},{value:"lock-tokens",id:"lock-tokens-1",level:3},{value:"begin-unlock-by-id",id:"begin-unlock-by-id",level:3},{value:"begin-unlock-tokens",id:"begin-unlock-tokens",level:3},{value:"Queries",id:"queries",level:2},{value:"account-locked-beforetime",id:"account-locked-beforetime",level:3},{value:"account-locked-coins",id:"account-locked-coins",level:3},{value:"account-locked-longer-duration",id:"account-locked-longer-duration",level:3},{value:"account-locked-longer-duration-denom",id:"account-locked-longer-duration-denom",level:3},{value:"account-locked-longer-duration-not-unlocking",id:"account-locked-longer-duration-not-unlocking",level:3},{value:"account-locked-pasttime",id:"account-locked-pasttime",level:3},{value:"account-locked-pasttime-denom",id:"account-locked-pasttime-denom",level:3},{value:"account-locked-pasttime-not-unlocking",id:"account-locked-pasttime-not-unlocking",level:3},{value:"account-unlockable-coins",id:"account-unlockable-coins",level:3},{value:"account-unlocking-coins",id:"account-unlocking-coins",level:3},{value:"lock-by-id",id:"lock-by-id",level:3},{value:"module-balance",id:"module-balance",level:3},{value:"module-locked-amount",id:"module-locked-amount",level:3},{value:"output-all-locks",id:"output-all-locks",level:3},{value:"total-locked-of-denom",id:"total-locked-of-denom",level:3},{value:"Commands",id:"commands",level:2}],k={toc:c};function d(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,o.Z)({},k,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"lockup"},"Lockup"),(0,a.kt)("h2",{id:"abstract"},"Abstract"),(0,a.kt)("p",null,"Lockup module provides an interface for users to lock tokens (also known as bonding) into the module to get incentives."),(0,a.kt)("p",null,"After tokens have been added to a specific pool and turned into LP shares through the GAMM module, users can then lock these LP shares with a specific duration in order to begin earing rewards."),(0,a.kt)("p",null,"To unlock these LP shares, users must trigger the unlock timer and wait for the unlock period that was set initially to be completed. After the unlock period is over, users can turn LP shares back into their respective share of tokens."),(0,a.kt)("p",null,"This module provides interfaces for other modules to iterate the locks efficiently and grpc query to check the status of locked coins."),(0,a.kt)("h2",{id:"contents"},"Contents"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("a",{parentName:"strong",href:"#concepts"},"Concept"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("a",{parentName:"strong",href:"#state"},"State"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("a",{parentName:"strong",href:"#messages"},"Messages"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("a",{parentName:"strong",href:"#events"},"Events"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("a",{parentName:"strong",href:"#keeper"},"Keeper"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("a",{parentName:"strong",href:"#hooks"},"Hooks"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("a",{parentName:"strong",href:"#queries"},"Queries"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("a",{parentName:"strong",href:"#transactions"},"Transactions"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("a",{parentName:"strong",href:"#params"},"Params"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("a",{parentName:"strong",href:"#endblocker"},"Endblocker")))),(0,a.kt)("h2",{id:"concepts"},"Concepts"),(0,a.kt)("p",null,"The purpose of ",(0,a.kt)("inlineCode",{parentName:"p"},"lockup")," module is to provide the functionality to lock\ntokens for specific period of time for LP token stakers to get\nincentives."),(0,a.kt)("p",null,"To unlock these LP shares, users must trigger the unlock timer and wait for the unlock period that was set initially to be completed. After the unlock period is over, users can turn LP shares back into their respective share of tokens."),(0,a.kt)("p",null,"This module provides interfaces for other modules to iterate the locks efficiently and grpc query to check the status of locked coins."),(0,a.kt)("p",null,"There are currently three incentivize lockup periods; ",(0,a.kt)("inlineCode",{parentName:"p"},"1 day")," (24h), ",(0,a.kt)("inlineCode",{parentName:"p"},"1 week")," (168h), and ",(0,a.kt)("inlineCode",{parentName:"p"},"2 weeks")," (336h). When locking tokens in the 2 week period, the liquidity provider is effectively earning rewards for a combination of the 1 day, 1 week, and 2 week bonding periods."),(0,a.kt)("p",null,"The 2 week period refers to how long it takes to unbond the LP shares. The liquidity provider can keep their LP shares bonded to the 2 week lockup period indefinitely. Unbonding is only required when the liquidity provider desires access to the underlying assets."),(0,a.kt)("p",null,"If the liquidity provider begins the unbonding process for their 2 week bonded LP shares, they will earn rewards for all three bonding periods during the first day of unbonding."),(0,a.kt)("p",null,"After the first day passes, they will only receive rewards for the 1 day and 1 week lockup periods. After seven days pass, they will only receive the 1 day rewards until the 2 weeks is complete and their LP shares are unlocked. The below chart is a visual example of what was just explained."),(0,a.kt)("p",null,(0,a.kt)("img",{src:"https://user-images.githubusercontent.com/13665117/191089636-7bdb5450-3883-4fc5-a514-a901514fcf8f.png",height:"300"})),(0,a.kt)("h2",{id:"state"},"State"),(0,a.kt)("h3",{id:"locked-coins-management"},"Locked coins management"),(0,a.kt)("p",null,"Locked coins are all stored in module account for ",(0,a.kt)("inlineCode",{parentName:"p"},"lockup")," module which\nis called ",(0,a.kt)("inlineCode",{parentName:"p"},"LockPool"),". When user lock coins within ",(0,a.kt)("inlineCode",{parentName:"p"},"lockup")," module, it's\nmoved from user account to ",(0,a.kt)("inlineCode",{parentName:"p"},"LockPool")," and a record (",(0,a.kt)("inlineCode",{parentName:"p"},"PeriodLock")," struct)\nis created."),(0,a.kt)("p",null,"Once the period is over, user can withdraw it at anytime from\n",(0,a.kt)("inlineCode",{parentName:"p"},"LockPool"),". User can withdraw by PeriodLock ID or withdraw all\n",(0,a.kt)("inlineCode",{parentName:"p"},"UnlockableCoins")," at a time."),(0,a.kt)("h3",{id:"period-lock"},"Period Lock"),(0,a.kt)("p",null,"A ",(0,a.kt)("inlineCode",{parentName:"p"},"PeriodLock")," is a single unit of lock by period. It's a record of\nlocked coin at a specific time. It stores owner, duration, unlock time\nand the amount of coins locked."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-{.go}"},"type PeriodLock struct {\n  ID         uint64\n  Owner      sdk.AccAddress\n  Duration   time.Duration\n  UnlockTime time.Time\n  Coins      sdk.Coins\n}\n")),(0,a.kt)("p",null,"All locks are stored on the KVStore as value at\n",(0,a.kt)("inlineCode",{parentName:"p"},"{KeyPrefixPeriodLock}{ID}")," key."),(0,a.kt)("h3",{id:"period-lock-reference-queues"},"Period lock reference queues"),(0,a.kt)("p",null,"To provide time efficient queries, several reference queues are managed\nby denom, unlock time, and duration. There are two big queues to store\nthe lock references. (",(0,a.kt)("inlineCode",{parentName:"p"},"a_prefix_key"),")"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Lock references that hasn't started with unlocking yet has prefix of\n",(0,a.kt)("inlineCode",{parentName:"li"},"KeyPrefixNotUnlocking"),"."),(0,a.kt)("li",{parentName:"ol"},"Lock references that has started unlocking already has prefix of\n",(0,a.kt)("inlineCode",{parentName:"li"},"KeyPrefixUnlocking"),"."),(0,a.kt)("li",{parentName:"ol"},"Lock references that has withdrawn, it's removed from the store.")),(0,a.kt)("p",null,"Regardless the lock has started unlocking or not, it stores below\nreferences. (",(0,a.kt)("inlineCode",{parentName:"p"},"b_prefix_key"),")"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"{KeyPrefixLockDuration}{Duration}")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"{KeyPrefixAccountLockDuration}{Owner}{Duration}")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"{KeyPrefixDenomLockDuration}{Denom}{Duration}")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"{KeyPrefixAccountDenomLockDuration}{Owner}{Denom}{Duration}"))),(0,a.kt)("p",null,"If the lock is unlocking, it also stores the below references."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"{KeyPrefixLockTimestamp}{LockEndTime}")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"{KeyPrefixAccountLockTimestamp}{Owner}{LockEndTime}")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"{KeyPrefixDenomLockTimestamp}{Denom}{LockEndTime}")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"{KeyPrefixAccountDenomLockTimestamp}{Owner}{Denom}{LockEndTime}"))),(0,a.kt)("p",null,"For end time keys, they are converted to sortable string by using\n",(0,a.kt)("inlineCode",{parentName:"p"},"sdk.FormatTimeBytes")," function."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Note:")," Additionally, for locks that hasn't started unlocking yet, it\nstores accumulation store for efficient rewards distribution mechanism."),(0,a.kt)("p",null,"For reference management, ",(0,a.kt)("inlineCode",{parentName:"p"},"addLockRefByKey")," function is used a lot. Here\nkey is the prefix key to be used for iteration. It is combination of two\nprefix keys.(",(0,a.kt)("inlineCode",{parentName:"p"},"{a_prefix_key}{b_prefix_key}"),")"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-{.go}"},'// addLockRefByKey make a lockID iterable with the prefix `key`\nfunc (k Keeper) addLockRefByKey(ctx sdk.Context, key []byte, lockID uint64) error {\n store := ctx.KVStore(k.storeKey)\n lockIDBz := sdk.Uint64ToBigEndian(lockID)\n endKey := combineKeys(key, lockIDBz)\n if store.Has(endKey) {\n  return fmt.Errorf("lock with same ID exist: %d", lockID)\n }\n store.Set(endKey, lockIDBz)\n return nil\n}\n')),(0,a.kt)("h3",{id:"synthetic-lockup"},"Synthetic Lockup"),(0,a.kt)("p",null,"Synthetic Lockups are a concept that serve the following roles:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},'Add "restrictions" to an underlying PeriodLock, so that its bond\nstatus must be managed by a module rather than a BeginUnlockMessage'),(0,a.kt)("li",{parentName:"ul"},'Allow issuing of a locked, "synthetic" denom type'),(0,a.kt)("li",{parentName:"ul"},"Allow distribution of rewards to locked synthetic denominations.")),(0,a.kt)("p",null,"The first goal can eventually be pushed into a new data structure, as it\ndoesn't really relate to the synthetic component."),(0,a.kt)("p",null,"This is then used for superfluid staking. (Old docs below):"),(0,a.kt)("p",null,"The goal of synthetic lockup is to support the querying of locks by\ndenom especially for delegated staking. By combining native denom and\nsynthetic suffix, lockup supports querying with synthetic denom with\nexisting denom querying functions."),(0,a.kt)("p",null,"Synthetic lockup is creating virtual lockup where new denom is\ncombination of original denom and synthetic suffix. At the time of\nsynthetic lockup creation and deletion, accumulation store is also being\nupdated and on querier side, they can query as freely as native lockup."),(0,a.kt)("p",null,"Note: The staking, distribution, slashing, superfluid module would be\nrefactored to use lockup module and synthetic lockup. The following\nchanges for synthetic lockup on native lockup change could be defined as\nper use case. For now we assume this change is made on hook receiver\nside which manages synthetic lockup, e.g. use cases are when user start\n/ pause superfluid staking on a lockup, redelegation event, unbonding\nevent etc."),(0,a.kt)("p",null,"External modules are managing synthetic locks to use it on their own\nlogic implementation. (e.g. delegated staking and superfluid staking)"),(0,a.kt)("p",null,"A ",(0,a.kt)("inlineCode",{parentName:"p"},"SyntheticLock")," is a single unit of synthetic lockup. Each synthetic\nlockup has reference ",(0,a.kt)("inlineCode",{parentName:"p"},"PeriodLock")," ID, synthetic suffix (",(0,a.kt)("inlineCode",{parentName:"p"},"Suffix"),") and\nsynthetic lock's removal time (",(0,a.kt)("inlineCode",{parentName:"p"},"EndTime"),")."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-{.go}"},"type SyntheticLock struct {\n LockId  uint64\n Suffix  string\n EndTime time.Time\n}\n")),(0,a.kt)("p",null,"All synthetic locks are stored on the KVStore as value at\n",(0,a.kt)("inlineCode",{parentName:"p"},"{KeyPrefixPeriodLock}{LockID}{Suffix}")," key."),(0,a.kt)("h3",{id:"synthetic-lock-reference-queues"},"Synthetic lock reference queues"),(0,a.kt)("p",null,"To provide time efficient queries, several reference queues are managed\nby denom, unlock time, and duration."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"{KeyPrefixDenomLockTimestamp}{SyntheticDenom}{LockEndTime}")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"{KeyPrefixDenomLockDuration}{SyntheticDenom}{Duration}")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"{KeyPrefixAccountDenomLockTimestamp}{Owner}{SyntheticDenom}{LockEndTime}")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"{KeyPrefixAccountDenomLockDuration}{Owner}{SyntheticDenom}{Duration}"))),(0,a.kt)("p",null,"SyntheticDenom is expressed as ",(0,a.kt)("inlineCode",{parentName:"p"},"{Denom}{Suffix}"),". (Note: we can change\nthis to ",(0,a.kt)("inlineCode",{parentName:"p"},"{Prefix}{Denom}")," as per discussion with Dev)"),(0,a.kt)("p",null,"For end time keys, they are converted to sortable string by using\n",(0,a.kt)("inlineCode",{parentName:"p"},"sdk.FormatTimeBytes")," function."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Note:")," To implement the auto removal of synthetic lockups that is\nalready finished, we manage a separate time basis queue at\n",(0,a.kt)("inlineCode",{parentName:"p"},"{KeyPrefixSyntheticLockTimestamp}{EndTime}{LockId}{Suffix}")),(0,a.kt)("h2",{id:"messages"},"Messages"),(0,a.kt)("h3",{id:"lock-tokens"},"Lock Tokens"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"MsgLockTokens")," can be submitted by any token holder via a\n",(0,a.kt)("inlineCode",{parentName:"p"},"MsgLockTokens")," transaction."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-{.go}"},"type MsgLockTokens struct {\n Owner    sdk.AccAddress\n Duration time.Duration\n Coins    sdk.Coins\n}\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"State modifications:")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Validate ",(0,a.kt)("inlineCode",{parentName:"li"},"Owner")," has enough tokens"),(0,a.kt)("li",{parentName:"ul"},"Generate new ",(0,a.kt)("inlineCode",{parentName:"li"},"PeriodLock")," record"),(0,a.kt)("li",{parentName:"ul"},"Save the record inside the keeper's time basis unlock queue"),(0,a.kt)("li",{parentName:"ul"},"Transfer the tokens from the ",(0,a.kt)("inlineCode",{parentName:"li"},"Owner")," to lockup ",(0,a.kt)("inlineCode",{parentName:"li"},"ModuleAccount"),".")),(0,a.kt)("h3",{id:"begin-unlock-of-all-locks"},"Begin Unlock of all locks"),(0,a.kt)("p",null,"Once time is over, users can withdraw unlocked coins from lockup\n",(0,a.kt)("inlineCode",{parentName:"p"},"ModuleAccount"),"."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-{.go}"},"type MsgBeginUnlockingAll struct {\n Owner string\n}\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"State modifications:")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Fetch all unlockable ",(0,a.kt)("inlineCode",{parentName:"li"},"PeriodLock"),"s that has not started unlocking\nyet"),(0,a.kt)("li",{parentName:"ul"},"Set ",(0,a.kt)("inlineCode",{parentName:"li"},"PeriodLock"),"'s unlock time"),(0,a.kt)("li",{parentName:"ul"},"Remove lock references from ",(0,a.kt)("inlineCode",{parentName:"li"},"NotUnlocking")," queue"),(0,a.kt)("li",{parentName:"ul"},"Add lock references to ",(0,a.kt)("inlineCode",{parentName:"li"},"Unlocking")," queue")),(0,a.kt)("h3",{id:"begin-unlock-for-a-lock"},"Begin unlock for a lock"),(0,a.kt)("p",null,"Once time is over, users can withdraw unlocked coins from lockup\n",(0,a.kt)("inlineCode",{parentName:"p"},"ModuleAccount"),"."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-{.go}"},"type MsgBeginUnlocking struct {\n Owner string\n ID    uint64\n}\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"State modifications:")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Check ",(0,a.kt)("inlineCode",{parentName:"li"},"PeriodLock")," with ",(0,a.kt)("inlineCode",{parentName:"li"},"ID")," specified by ",(0,a.kt)("inlineCode",{parentName:"li"},"MsgBeginUnlocking")," is not\nstarted unlocking yet"),(0,a.kt)("li",{parentName:"ul"},"Set ",(0,a.kt)("inlineCode",{parentName:"li"},"PeriodLock"),"'s unlock time"),(0,a.kt)("li",{parentName:"ul"},"Remove lock references from ",(0,a.kt)("inlineCode",{parentName:"li"},"NotUnlocking")," queue"),(0,a.kt)("li",{parentName:"ul"},"Add lock references to ",(0,a.kt)("inlineCode",{parentName:"li"},"Unlocking")," queue")),(0,a.kt)("p",null,"Note: If another module needs past ",(0,a.kt)("inlineCode",{parentName:"p"},"PeriodLock")," item, it can log the\ndetails themselves using the hooks."),(0,a.kt)("h2",{id:"events"},"Events"),(0,a.kt)("p",null,"The lockup module emits the following events:"),(0,a.kt)("h3",{id:"handlers"},"Handlers"),(0,a.kt)("h4",{id:"msglocktokens"},"MsgLockTokens"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Attribute Key"),(0,a.kt)("th",{parentName:"tr",align:null},"Attribute Value"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"lock","_","tokens"),(0,a.kt)("td",{parentName:"tr",align:null},"period","_","lock","_","id"),(0,a.kt)("td",{parentName:"tr",align:null},"{periodLockID}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"lock","_","tokens"),(0,a.kt)("td",{parentName:"tr",align:null},"owner"),(0,a.kt)("td",{parentName:"tr",align:null},"{owner}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"lock","_","tokens"),(0,a.kt)("td",{parentName:"tr",align:null},"amount"),(0,a.kt)("td",{parentName:"tr",align:null},"{amount}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"lock","_","tokens"),(0,a.kt)("td",{parentName:"tr",align:null},"duration"),(0,a.kt)("td",{parentName:"tr",align:null},"{duration}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"lock","_","tokens"),(0,a.kt)("td",{parentName:"tr",align:null},"unlock","_","time"),(0,a.kt)("td",{parentName:"tr",align:null},"{unlockTime}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"message"),(0,a.kt)("td",{parentName:"tr",align:null},"action"),(0,a.kt)("td",{parentName:"tr",align:null},"lock","_","tokens")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"message"),(0,a.kt)("td",{parentName:"tr",align:null},"sender"),(0,a.kt)("td",{parentName:"tr",align:null},"{owner}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"transfer"),(0,a.kt)("td",{parentName:"tr",align:null},"recipient"),(0,a.kt)("td",{parentName:"tr",align:null},"{moduleAccount}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"transfer"),(0,a.kt)("td",{parentName:"tr",align:null},"sender"),(0,a.kt)("td",{parentName:"tr",align:null},"{owner}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"transfer"),(0,a.kt)("td",{parentName:"tr",align:null},"amount"),(0,a.kt)("td",{parentName:"tr",align:null},"{amount}")))),(0,a.kt)("h4",{id:"msgbeginunlocking"},"MsgBeginUnlocking"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Attribute Key"),(0,a.kt)("th",{parentName:"tr",align:null},"Attribute Value"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"begin","_","unlock"),(0,a.kt)("td",{parentName:"tr",align:null},"period","_","lock","_","id"),(0,a.kt)("td",{parentName:"tr",align:null},"{periodLockID}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"begin","_","unlock"),(0,a.kt)("td",{parentName:"tr",align:null},"owner"),(0,a.kt)("td",{parentName:"tr",align:null},"{owner}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"begin","_","unlock"),(0,a.kt)("td",{parentName:"tr",align:null},"amount"),(0,a.kt)("td",{parentName:"tr",align:null},"{amount}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"begin","_","unlock"),(0,a.kt)("td",{parentName:"tr",align:null},"duration"),(0,a.kt)("td",{parentName:"tr",align:null},"{duration}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"begin","_","unlock"),(0,a.kt)("td",{parentName:"tr",align:null},"unlock","_","time"),(0,a.kt)("td",{parentName:"tr",align:null},"{unlockTime}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"message"),(0,a.kt)("td",{parentName:"tr",align:null},"action"),(0,a.kt)("td",{parentName:"tr",align:null},"begin","_","unlocking")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"message"),(0,a.kt)("td",{parentName:"tr",align:null},"sender"),(0,a.kt)("td",{parentName:"tr",align:null},"{owner}")))),(0,a.kt)("h4",{id:"msgbeginunlockingall"},"MsgBeginUnlockingAll"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Attribute Key"),(0,a.kt)("th",{parentName:"tr",align:null},"Attribute Value"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"begin","_","unlock","_","all"),(0,a.kt)("td",{parentName:"tr",align:null},"owner"),(0,a.kt)("td",{parentName:"tr",align:null},"{owner}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"begin","_","unlock","_","all"),(0,a.kt)("td",{parentName:"tr",align:null},"unlocked","_","coins"),(0,a.kt)("td",{parentName:"tr",align:null},"{unlockedCoins}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"begin","_","unlock"),(0,a.kt)("td",{parentName:"tr",align:null},"period","_","lock","_","id"),(0,a.kt)("td",{parentName:"tr",align:null},"{periodLockID}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"begin","_","unlock"),(0,a.kt)("td",{parentName:"tr",align:null},"owner"),(0,a.kt)("td",{parentName:"tr",align:null},"{owner}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"begin","_","unlock"),(0,a.kt)("td",{parentName:"tr",align:null},"amount"),(0,a.kt)("td",{parentName:"tr",align:null},"{amount}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"begin","_","unlock"),(0,a.kt)("td",{parentName:"tr",align:null},"duration"),(0,a.kt)("td",{parentName:"tr",align:null},"{duration}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"begin","_","unlock"),(0,a.kt)("td",{parentName:"tr",align:null},"unlock","_","time"),(0,a.kt)("td",{parentName:"tr",align:null},"{unlockTime}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"message"),(0,a.kt)("td",{parentName:"tr",align:null},"action"),(0,a.kt)("td",{parentName:"tr",align:null},"begin","_","unlocking","_","all")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"message"),(0,a.kt)("td",{parentName:"tr",align:null},"sender"),(0,a.kt)("td",{parentName:"tr",align:null},"{owner}")))),(0,a.kt)("h3",{id:"endblocker"},"Endblocker"),(0,a.kt)("h4",{id:"automatic-withdraw-when-unlock-time-mature"},"Automatic withdraw when unlock time mature"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Attribute Key"),(0,a.kt)("th",{parentName:"tr",align:null},"Attribute Value"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"message"),(0,a.kt)("td",{parentName:"tr",align:null},"action"),(0,a.kt)("td",{parentName:"tr",align:null},"unlock","_","tokens")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"message"),(0,a.kt)("td",{parentName:"tr",align:null},"sender"),(0,a.kt)("td",{parentName:"tr",align:null},"{owner}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"transfer","[","]"),(0,a.kt)("td",{parentName:"tr",align:null},"recipient"),(0,a.kt)("td",{parentName:"tr",align:null},"{owner}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"transfer","[","]"),(0,a.kt)("td",{parentName:"tr",align:null},"sender"),(0,a.kt)("td",{parentName:"tr",align:null},"{moduleAccount}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"transfer","[","]"),(0,a.kt)("td",{parentName:"tr",align:null},"amount"),(0,a.kt)("td",{parentName:"tr",align:null},"{unlockAmount}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"unlock","[","]"),(0,a.kt)("td",{parentName:"tr",align:null},"period","_","lock","_","id"),(0,a.kt)("td",{parentName:"tr",align:null},"{owner}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"unlock","[","]"),(0,a.kt)("td",{parentName:"tr",align:null},"owner"),(0,a.kt)("td",{parentName:"tr",align:null},"{lockID}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"unlock","[","]"),(0,a.kt)("td",{parentName:"tr",align:null},"duration"),(0,a.kt)("td",{parentName:"tr",align:null},"{lockDuration}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"unlock","[","]"),(0,a.kt)("td",{parentName:"tr",align:null},"unlock","_","time"),(0,a.kt)("td",{parentName:"tr",align:null},"{unlockTime}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"unlock","_","tokens"),(0,a.kt)("td",{parentName:"tr",align:null},"owner"),(0,a.kt)("td",{parentName:"tr",align:null},"{owner}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"unlock","_","tokens"),(0,a.kt)("td",{parentName:"tr",align:null},"unlocked","_","coins"),(0,a.kt)("td",{parentName:"tr",align:null},"{totalAmount}")))),(0,a.kt)("h2",{id:"keepers"},"Keepers"),(0,a.kt)("h3",{id:"lockup-keeper"},"Lockup Keeper"),(0,a.kt)("p",null,"Lockup keeper provides utility functions to store lock queues and query\nlocks."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},"// Keeper is the interface for lockup module keeper\ntype Keeper interface {\n    // GetModuleBalance Returns full balance of the module\n    GetModuleBalance(sdk.Context) sdk.Coins\n    // GetModuleLockedCoins Returns locked balance of the module\n    GetModuleLockedCoins(sdk.Context) sdk.Coins\n    // GetAccountUnlockableCoins Returns whole unlockable coins which are not withdrawn yet\n    GetAccountUnlockableCoins(sdk.Context, addr sdk.AccAddress) sdk.Coins\n    // GetAccountUnlockingCoins Returns whole unlocking coins\n    GetAccountUnlockingCoins(sdk.Context, addr sdk.AccAddress) sdk.Coins\n    // GetAccountLockedCoins Returns a locked coins that can't be withdrawn\n    GetAccountLockedCoins(sdk.Context, addr sdk.AccAddress) sdk.Coins\n    // GetAccountLockedPastTime Returns the total locks of an account whose unlock time is beyond timestamp\n    GetAccountLockedPastTime(sdk.Context, addr sdk.AccAddress, timestamp time.Time) []types.PeriodLock\n    // GetAccountUnlockedBeforeTime Returns the total unlocks of an account whose unlock time is before timestamp\n    GetAccountUnlockedBeforeTime(sdk.Context, addr sdk.AccAddress, timestamp time.Time) []types.PeriodLock\n    // GetAccountLockedPastTimeDenom is equal to GetAccountLockedPastTime but denom specific\n    GetAccountLockedPastTimeDenom(ctx sdk.Context, addr sdk.AccAddress, denom string, timestamp time.Time) []types.PeriodLock\n\n    // GetAccountLockedLongerDuration Returns account locked with duration longer than specified\n    GetAccountLockedLongerDuration(sdk.Context, addr sdk.AccAddress, duration time.Duration) []types.PeriodLock\n    // GetAccountLockedLongerDurationDenom Returns account locked with duration longer than specified with specific denom\n    GetAccountLockedLongerDurationDenom(sdk.Context, addr sdk.AccAddress, denom string, duration time.Duration) []types.PeriodLock\n    // GetLocksPastTimeDenom Returns the locks whose unlock time is beyond timestamp\n    GetLocksPastTimeDenom(ctx sdk.Context, addr sdk.AccAddress, denom string, timestamp time.Time) []types.PeriodLock\n    // GetLocksLongerThanDurationDenom Returns the locks whose unlock duration is longer than duration\n    GetLocksLongerThanDurationDenom(ctx sdk.Context, addr sdk.AccAddress, denom string, duration time.Duration) []types.PeriodLock\n    // GetLockByID Returns lock from lockID\n    GetLockByID(sdk.Context, lockID uint64) (*types.PeriodLock, error)\n    // GetPeriodLocks Returns the period locks on pool\n    GetPeriodLocks(sdk.Context) ([]types.PeriodLock, error)\n    // UnlockAllUnlockableCoins Unlock all unlockable coins\n    UnlockAllUnlockableCoins(sdk.Context, account sdk.AccAddress) (sdk.Coins, error)\n    // LockTokens lock tokens from an account for specified duration\n    LockTokens(sdk.Context, owner sdk.AccAddress, coins sdk.Coins, duration time.Duration) (types.PeriodLock, error)\n    // AddTokensToLock locks more tokens into a lockup\n    AddTokensToLock(ctx sdk.Context, owner sdk.AccAddress, lockID uint64, coins sdk.Coins) (*types.PeriodLock, error)\n    // Lock is a utility to lock coins into module account\n    Lock(sdk.Context, lock types.PeriodLock) error\n    // Unlock is a utility to unlock coins from module account\n    Unlock(sdk.Context, lock types.PeriodLock) error\n    GetSyntheticLockup(ctx sdk.Context, lockID uint64, suffix string) (*types.SyntheticLock, error)\n    GetAllSyntheticLockupsByLockup(ctx sdk.Context, lockID uint64) []types.SyntheticLock\n    GetAllSyntheticLockups(ctx sdk.Context) []types.SyntheticLock\n    // CreateSyntheticLockup create synthetic lockup with lock id and denom suffix\n    CreateSyntheticLockup(ctx sdk.Context, lockID uint64, suffix string, unlockDuration time.Duration) error\n    // DeleteSyntheticLockup delete synthetic lockup with lock id and suffix\n    DeleteSyntheticLockup(ctx sdk.Context, lockID uint64, suffix string) error\n    DeleteAllMaturedSyntheticLocks(ctx sdk.Context)\n")),(0,a.kt)("h3",{id:"lock-admin-keeper"},"Lock Admin Keeper"),(0,a.kt)("p",null,"Lockup admin keeper provides god privilege functions to remove tokens\nfrom locks and create new locks."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'// AdminKeeper defines a god privilege keeper functions to remove tokens from locks and create new locks\n// For the governance system of token pools, we want a "ragequit" feature\n// So governance changes will take 1 week to go into effect\n// During that time, people can choose to "ragequit" which means they would leave the original pool\n// and form a new pool with the old parameters but if they still had 2 months of lockup left,\n// their liquidity still needs to be 2 month lockup-ed, just in the new pool\n// And we need to replace their pool1 LP tokens with pool2 LP tokens with the same lock duration and end time\n\ntype AdminKeeper interface {\n    Keeper\n\n    // this unlock previous lockID and create a new lock with newCoins with same duration and endtime\n    Relock(sdk.Context, lockID uint64, newCoins sdk.Coins) error\n    // this unlock without time check with an admin privilege\n    BreakLock(sdk.Context, lockID uint64) error\n}\n')),(0,a.kt)("h2",{id:"hooks"},"Hooks"),(0,a.kt)("p",null,'In this section we describe the "hooks" that ',(0,a.kt)("inlineCode",{parentName:"p"},"lockup")," module provide for\nother modules."),(0,a.kt)("h3",{id:"tokens-locked"},"Tokens Locked"),(0,a.kt)("p",null,"On lock/unlock events, lockup module execute hooks for other modules to\nmake following actions."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},"  OnTokenLocked(ctx sdk.Context, address sdk.AccAddress, lockID uint64, amount sdk.Coins, lockDuration time.Duration, unlockTime time.Time)\n  OnTokenUnlocked(ctx sdk.Context, address sdk.AccAddress, lockID uint64, amount sdk.Coins, lockDuration time.Duration, unlockTime time.Time)\n")),(0,a.kt)("h2",{id:"parameters"},"Parameters"),(0,a.kt)("p",null,"The lockup module contains the following parameters:"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Key"),(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Example")))),(0,a.kt)("p",null,"Note: Currently no parameters are set for ",(0,a.kt)("inlineCode",{parentName:"p"},"lockup")," module, we will need\nto move lockable durations from incentives module to lockup module."),(0,a.kt)("h2",{id:"endblocker-1"},"Endblocker"),(0,a.kt)("h3",{id:"withdraw-tokens-after-unlock-time-mature"},"Withdraw tokens after unlock time mature"),(0,a.kt)("p",null,"Once time is over, endblocker withdraw coins from matured locks and\ncoins are sent from lockup ",(0,a.kt)("inlineCode",{parentName:"p"},"ModuleAccount"),"."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"State modifications:")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Fetch all unlockable ",(0,a.kt)("inlineCode",{parentName:"li"},"PeriodLock"),"s that ",(0,a.kt)("inlineCode",{parentName:"li"},"Owner")," has not withdrawn\nyet"),(0,a.kt)("li",{parentName:"ul"},"Remove ",(0,a.kt)("inlineCode",{parentName:"li"},"PeriodLock")," records from the state"),(0,a.kt)("li",{parentName:"ul"},"Transfer the tokens from lockup ",(0,a.kt)("inlineCode",{parentName:"li"},"ModuleAccount")," to the\n",(0,a.kt)("inlineCode",{parentName:"li"},"MsgUnlockTokens.Owner"),".")),(0,a.kt)("h3",{id:"remove-synthetic-locks-after-removal-time-mature"},"Remove synthetic locks after removal time mature"),(0,a.kt)("p",null,"For synthetic lockups, no coin movement is made, but lockup record and\nreference queues are removed."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"State modifications:")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Fetch all synthetic lockups that is matured"),(0,a.kt)("li",{parentName:"ul"},"Remove ",(0,a.kt)("inlineCode",{parentName:"li"},"SyntheticLock")," records from the state along with reference\nqueues")),(0,a.kt)("h2",{id:"transactions"},"Transactions"),(0,a.kt)("h3",{id:"lock-tokens-1"},"lock-tokens"),(0,a.kt)("p",null,"Bond tokens in a LP for a set duration"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd tx lockup lock-tokens [tokens] --duration --from --chain-id\n")),(0,a.kt)("p",null,"::: details Example"),(0,a.kt)("p",null,"To lockup ",(0,a.kt)("inlineCode",{parentName:"p"},"15.527546134174465309gamm/pool/3")," tokens for a ",(0,a.kt)("inlineCode",{parentName:"p"},"one day")," bonding period from ",(0,a.kt)("inlineCode",{parentName:"p"},"WALLET_NAME")," on the osmosis mainnet:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'osmosisd tx lockup lock-tokens 15527546134174465309gamm/pool/3 --duration="24h" --from WALLET_NAME --chain-id osmosis-1\n')),(0,a.kt)("p",null,"To lockup ",(0,a.kt)("inlineCode",{parentName:"p"},"25.527546134174465309gamm/pool/13")," tokens for a ",(0,a.kt)("inlineCode",{parentName:"p"},"one week")," bonding period from ",(0,a.kt)("inlineCode",{parentName:"p"},"WALLET_NAME")," on the osmosis testnet:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'osmosisd tx lockup lock-tokens 25527546134174465309gamm/pool/13 --duration="168h" --from WALLET_NAME --chain-id osmo-test-5\n')),(0,a.kt)("p",null,"To lockup ",(0,a.kt)("inlineCode",{parentName:"p"},"35.527546134174465309 gamm/pool/197")," tokens for a ",(0,a.kt)("inlineCode",{parentName:"p"},"two week")," bonding period from ",(0,a.kt)("inlineCode",{parentName:"p"},"WALLET_NAME")," on the osmosis mainnet:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'osmosisd tx lockup lock-tokens 35527546134174465309gamm/pool/197 --duration="336h" --from WALLET_NAME --chain-id osmosis-1\n')),(0,a.kt)("p",null,":::"),(0,a.kt)("h3",{id:"begin-unlock-by-id"},"begin-unlock-by-id"),(0,a.kt)("p",null,"Begin the unbonding process for tokens given their unique lock ID"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd tx lockup begin-unlock-by-id [id] --from --chain-id\n")),(0,a.kt)("p",null,"::: details Example"),(0,a.kt)("p",null,"To begin the unbonding time for all bonded tokens under id ",(0,a.kt)("inlineCode",{parentName:"p"},"75")," from ",(0,a.kt)("inlineCode",{parentName:"p"},"WALLET_NAME")," on the osmosis mainnet:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"osmosisd tx lockup begin-unlock-by-id 75 --from WALLET_NAME --chain-id osmosis-1\n")),(0,a.kt)("p",null,":::\n::: warning Note\nThe ID corresponds to the unique ID given to your lockup transaction (explained more in lock-by-id section)\n:::"),(0,a.kt)("h3",{id:"begin-unlock-tokens"},"begin-unlock-tokens"),(0,a.kt)("p",null,"Begin unbonding process for all bonded tokens in a wallet"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd tx lockup begin-unlock-tokens --from --chain-id\n")),(0,a.kt)("p",null,"::: details Example"),(0,a.kt)("p",null,"To begin unbonding time for ALL pools and ALL bonded tokens in ",(0,a.kt)("inlineCode",{parentName:"p"},"WALLET_NAME")," on the osmosis mainnet:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"osmosisd tx lockup begin-unlock-tokens --from=WALLET_NAME --chain-id=osmosis-1 --yes\n")),(0,a.kt)("p",null,":::"),(0,a.kt)("h2",{id:"queries"},"Queries"),(0,a.kt)("p",null,"In this section we describe the queries required on grpc server."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-protobuf"},"// Query defines the gRPC querier service.\nservice Query {\n    // Return full balance of the module\n rpc ModuleBalance(ModuleBalanceRequest) returns (ModuleBalanceResponse);\n // Return locked balance of the module\n rpc ModuleLockedAmount(ModuleLockedAmountRequest) returns (ModuleLockedAmountResponse);\n\n // Returns unlockable coins which are not withdrawn yet\n rpc AccountUnlockableCoins(AccountUnlockableCoinsRequest) returns (AccountUnlockableCoinsResponse);\n // Returns unlocking coins\n   rpc AccountUnlockingCoins(AccountUnlockingCoinsRequest) returns (AccountUnlockingCoinsResponse) {}\n // Return a locked coins that can't be withdrawn\n rpc AccountLockedCoins(AccountLockedCoinsRequest) returns (AccountLockedCoinsResponse);\n\n // Returns locked records of an account with unlock time beyond timestamp\n rpc AccountLockedPastTime(AccountLockedPastTimeRequest) returns (AccountLockedPastTimeResponse);\n // Returns locked records of an account with unlock time beyond timestamp excluding tokens started unlocking\n rpc AccountLockedPastTimeNotUnlockingOnly(AccountLockedPastTimeNotUnlockingOnlyRequest) returns (AccountLockedPastTimeNotUnlockingOnlyResponse) {}\n // Returns unlocked records with unlock time before timestamp\n rpc AccountUnlockedBeforeTime(AccountUnlockedBeforeTimeRequest) returns (AccountUnlockedBeforeTimeResponse);\n\n // Returns lock records by address, timestamp, denom\n rpc AccountLockedPastTimeDenom(AccountLockedPastTimeDenomRequest) returns (AccountLockedPastTimeDenomResponse);\n // Returns lock record by id\n rpc LockedByID(LockedRequest) returns (LockedResponse);\n\n // Returns account locked records with longer duration\n rpc AccountLockedLongerDuration(AccountLockedLongerDurationRequest) returns (AccountLockedLongerDurationResponse);\n // Returns account locked records with longer duration excluding tokens started unlocking\n   rpc AccountLockedLongerDurationNotUnlockingOnly(AccountLockedLongerDurationNotUnlockingOnlyRequest) returns (AccountLockedLongerDurationNotUnlockingOnlyResponse) {}\n // Returns account's locked records for a denom with longer duration\n rpc AccountLockedLongerDurationDenom(AccountLockedLongerDurationDenomRequest) returns (AccountLockedLongerDurationDenomResponse);\n\n // Returns account locked records with a specific duration\n rpc AccountLockedDuration(AccountLockedDurationRequest) returns (AccountLockedDurationResponse);\n}\n")),(0,a.kt)("h3",{id:"account-locked-beforetime"},"account-locked-beforetime"),(0,a.kt)("p",null,"Query an account's unlocked records after a specified time (UNIX) has passed"),(0,a.kt)("p",null,"In other words, if an account unlocked all their bonded tokens the moment the query was executed, only the locks that would have completed their bond time requirement by the time the ",(0,a.kt)("inlineCode",{parentName:"p"},"TIMESTAMP")," is reached will be returned."),(0,a.kt)("p",null,"::: details Example"),(0,a.kt)("p",null,"In this example, the current UNIX time is ",(0,a.kt)("inlineCode",{parentName:"p"},"1639776682"),", 2 days from now is approx ",(0,a.kt)("inlineCode",{parentName:"p"},"1639971082"),", and 15 days from now is approx ",(0,a.kt)("inlineCode",{parentName:"p"},"1641094282"),"."),(0,a.kt)("p",null,"An account's ",(0,a.kt)("inlineCode",{parentName:"p"},"ADDRESS")," is locked in both the ",(0,a.kt)("inlineCode",{parentName:"p"},"1 day")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"1 week")," gamm/pool/3. To query the ",(0,a.kt)("inlineCode",{parentName:"p"},"ADDRESS")," with a timestamp 2 days from now ",(0,a.kt)("inlineCode",{parentName:"p"},"1639971082"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"osmosisd query lockup account-locked-beforetime ADDRESS 1639971082\n")),(0,a.kt)("p",null,"In this example will output the ",(0,a.kt)("inlineCode",{parentName:"p"},"1 day")," lock but not the ",(0,a.kt)("inlineCode",{parentName:"p"},"1 week")," lock:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'locks:\n- ID: "571839"\n  coins:\n  - amount: "15527546134174465309"\n    denom: gamm/pool/3\n  duration: 24h\n  end_time: "2021-12-18T23:32:58.900715388Z"\n  owner: osmo1xqhlshlhs5g0acqgrkafdemvf5kz4pp4c2x259\n')),(0,a.kt)("p",null,"If querying the same ",(0,a.kt)("inlineCode",{parentName:"p"},"ADDRESS")," with a timestamp 15 days from now ",(0,a.kt)("inlineCode",{parentName:"p"},"1641094282"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"osmosisd query lockup account-locked-beforetime ADDRESS 1641094282\n")),(0,a.kt)("p",null,"In this example will output both the ",(0,a.kt)("inlineCode",{parentName:"p"},"1 day")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"1 week")," lock:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'locks:\n- ID: "572027"\n  coins:\n  - amount: "16120691802759484268"\n    denom: gamm/pool/3\n  duration: 604800.000006193s\n  end_time: "0001-01-01T00:00:00Z"\n  owner: osmo1xqhlshlhs5g0acqgrkafdemvf5kz4pp4c2x259\n- ID: "571839"\n  coins:\n  - amount: "15527546134174465309"\n    denom: gamm/pool/3\n  duration: 24h\n  end_time: "2021-12-18T23:32:58.900715388Z"\n  owner: osmo1xqhlshlhs5g0acqgrkafdemvf5kz4pp4c2x259\n')),(0,a.kt)("p",null,":::"),(0,a.kt)("h3",{id:"account-locked-coins"},"account-locked-coins"),(0,a.kt)("p",null,"Query an account's locked (bonded) LP tokens"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query lockup account-locked-coins [address]\n")),(0,a.kt)("p",null,":::: details Example"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"osmosisd query lockup account-locked-coins osmo1xqhlshlhs5g0acqgrkafdemvf5kz4pp4c2x259\n")),(0,a.kt)("p",null,"An example output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'coins:\n- amount: "413553955105681228583"\n  denom: gamm/pool/1\n- amount: "32155370994266157441309"\n  denom: gamm/pool/10\n- amount: "220957857520769912023"\n  denom: gamm/pool/3\n- amount: "31648237936933949577"\n  denom: gamm/pool/42\n- amount: "14162624050980051053569"\n  denom: gamm/pool/5\n- amount: "1023186951315714985896914"\n  denom: gamm/pool/9\n')),(0,a.kt)("p",null,"::: warning Note\nAll GAMM amounts listed are 10^18. Move the decimal place to the left 18 places to get the GAMM amount listed in the GUI."),(0,a.kt)("p",null,"You may also specify a --height flag to see bonded LP tokens at a specified height (note: if running a pruned node, this may result in an error)\n:::\n::::"),(0,a.kt)("h3",{id:"account-locked-longer-duration"},"account-locked-longer-duration"),(0,a.kt)("p",null,"Query an account's locked records that are greater than or equal to a specified lock duration"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query lockup account-locked-longer-duration [address] [duration]\n")),(0,a.kt)("p",null,"::: details Example"),(0,a.kt)("p",null,"Here is an example of querying an ",(0,a.kt)("inlineCode",{parentName:"p"},"ADDRESS")," for all ",(0,a.kt)("inlineCode",{parentName:"p"},"1 day")," or greater bonding periods:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"osmosisd query lockup account-locked-longer-duration osmo1xqhlshlhs5g0acqgrkafdemvf5kz4pp4c2x259 24h\n")),(0,a.kt)("p",null,"An example output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'locks:\n- ID: "572027"\n  coins:\n  - amount: "16120691802759484268"\n    denom: gamm/pool/3\n  duration: 604800.000006193s\n  end_time: "0001-01-01T00:00:00Z"\n  owner: osmo1xqhlshlhs5g0acqgrkafdemvf5kz4pp4c2x259\n- ID: "571839"\n  coins:\n  - amount: "15527546134174465309"\n    denom: gamm/pool/3\n  duration: 24h\n  end_time: "2021-12-18T23:32:58.900715388Z"\n  owner: osmo1xqhlshlhs5g0acqgrkafdemvf5kz4pp4c2x259\n')),(0,a.kt)("p",null,":::"),(0,a.kt)("h3",{id:"account-locked-longer-duration-denom"},"account-locked-longer-duration-denom"),(0,a.kt)("p",null,"Query an account's locked records for a denom that is locked equal to or greater than the specified duration AND match a specified denom"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query lockup account-locked-longer-duration-denom [address] [duration] [denom]\n")),(0,a.kt)("p",null,"::: details Example"),(0,a.kt)("p",null,"Here is an example of an ",(0,a.kt)("inlineCode",{parentName:"p"},"ADDRESS")," that is locked in both the ",(0,a.kt)("inlineCode",{parentName:"p"},"1 day")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"1 week")," for both the gamm/pool/3 and gamm/pool/1, then queries the ",(0,a.kt)("inlineCode",{parentName:"p"},"ADDRESS")," for all bonding periods equal to or greater than ",(0,a.kt)("inlineCode",{parentName:"p"},"1 day")," for just the gamm/pool/3:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"osmosisd query lockup account-locked-longer-duration-denom osmo1xqhlshlhs5g0acqgrkafdemvf5kz4pp4c2x259 24h gamm/pool/3\n")),(0,a.kt)("p",null,"An example output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'locks:\n- ID: "571839"\n  coins:\n  - amount: "15527546134174465309"\n    denom: gamm/pool/3\n  duration: 24h\n  end_time: "0001-01-01T00:00:00Z"\n  owner: osmo1xqhlshlhs5g0acqgrkafdemvf5kz4pp4c2x259\n- ID: "572027"\n  coins:\n  - amount: "16120691802759484268"\n    denom: gamm/pool/3\n  duration: 604800.000006193s\n  end_time: "0001-01-01T00:00:00Z"\n  owner: osmo1xqhlshlhs5g0acqgrkafdemvf5kz4pp4c2x259\n')),(0,a.kt)("p",null,"As shown, the gamm/pool/3 is returned but not the gamm/pool/1 due to the denom filter.\n:::"),(0,a.kt)("h3",{id:"account-locked-longer-duration-not-unlocking"},"account-locked-longer-duration-not-unlocking"),(0,a.kt)("p",null,"Query an account's locked records for a denom that is locked equal to or greater than the specified duration AND is not in the process of being unlocked"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query lockup account-locked-longer-duration-not-unlocking [address] [duration]\n")),(0,a.kt)("p",null,"::: details Example"),(0,a.kt)("p",null,"Here is an example of an ",(0,a.kt)("inlineCode",{parentName:"p"},"ADDRESS")," that is locked in both the ",(0,a.kt)("inlineCode",{parentName:"p"},"1 day")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"1 week")," gamm/pool/3, begins unlocking process for the ",(0,a.kt)("inlineCode",{parentName:"p"},"1 day")," bond, and queries the ",(0,a.kt)("inlineCode",{parentName:"p"},"ADDRESS")," for all bonding periods equal to or greater than ",(0,a.kt)("inlineCode",{parentName:"p"},"1 day")," that are not unbonding:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"osmosisd query lockup account-locked-longer-duration-not-unlocking osmo1xqhlshlhs5g0acqgrkafdemvf5kz4pp4c2x259 24h\n")),(0,a.kt)("p",null,"An example output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'locks:\n- ID: "571839"\n  coins:\n  - amount: "16120691802759484268"\n    denom: gamm/pool/3\n  duration: 604800.000006193s\n  end_time: "0001-01-01T00:00:00Z"\n  owner: osmo1xqhlshlhs5g0acqgrkafdemvf5kz4pp4c2x259\n')),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"1 day")," bond does not show since it is in the process of unbonding.\n:::"),(0,a.kt)("h3",{id:"account-locked-pasttime"},"account-locked-pasttime"),(0,a.kt)("p",null,"Query the locked records of an account with the unlock time beyond timestamp (UNIX)"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"osmosisd query lockup account-locked-pasttime [address] [timestamp]\n")),(0,a.kt)("p",null,"::: details Example"),(0,a.kt)("p",null,"Here is an example of an account that is locked in both the ",(0,a.kt)("inlineCode",{parentName:"p"},"1 day")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"1 week")," gamm/pool/3. In this example, the UNIX time is currently ",(0,a.kt)("inlineCode",{parentName:"p"},"1639776682")," and queries an ",(0,a.kt)("inlineCode",{parentName:"p"},"ADDRESS")," for UNIX time two days later from the current time (which in this example would be ",(0,a.kt)("inlineCode",{parentName:"p"},"1639971082"),")"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"osmosisd query lockup account-locked-pasttime osmo1xqhlshlhs5g0acqgrkafdemvf5kz4pp4c2x259 1639971082\n")),(0,a.kt)("p",null,"The example output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'locks:\n- ID: "572027"\n  coins:\n  - amount: "16120691802759484268"\n    denom: gamm/pool/3\n  duration: 604800.000006193s\n  end_time: "0001-01-01T00:00:00Z"\n  owner: osmo1xqhlshlhs5g0acqgrkafdemvf5kz4pp4c2x259\n')),(0,a.kt)("p",null,"Note that the ",(0,a.kt)("inlineCode",{parentName:"p"},"1 day")," lock ID did not display because, if the unbonding time began counting down from the time the command was executed, the bonding period would be complete before the two day window given by the UNIX timestamp input.\n:::"),(0,a.kt)("h3",{id:"account-locked-pasttime-denom"},"account-locked-pasttime-denom"),(0,a.kt)("p",null,"Query the locked records of an account with the unlock time beyond timestamp (unix) and filter by a specific denom"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"osmosisd query lockup account-locked-pasttime-denom osmo1xqhlshlhs5g0acqgrkafdemvf5kz4pp4c2x259 [timestamp] [denom]\n")),(0,a.kt)("p",null,"::: details Example"),(0,a.kt)("p",null,"Here is an example of an account that is locked in both the ",(0,a.kt)("inlineCode",{parentName:"p"},"1 day")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"1 week")," gamm/pool/3 and ",(0,a.kt)("inlineCode",{parentName:"p"},"1 day")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"1 week")," gamm/pool/1. In this example, the UNIX time is currently ",(0,a.kt)("inlineCode",{parentName:"p"},"1639776682")," and queries an ",(0,a.kt)("inlineCode",{parentName:"p"},"ADDRESS")," for UNIX time two days later from the current time (which in this example would be ",(0,a.kt)("inlineCode",{parentName:"p"},"1639971082"),") and filters for gamm/pool/3"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"osmosisd query lockup account-locked-pasttime-denom osmo1xqhlshlhs5g0acqgrkafdemvf5kz4pp4c2x259 1639971082 gamm/pool/3\n")),(0,a.kt)("p",null,"The example output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'locks:\n- ID: "572027"\n  coins:\n  - amount: "16120691802759484268"\n    denom: gamm/pool/3\n  duration: 604800.000006193s\n  end_time: "0001-01-01T00:00:00Z"\n  owner: osmo1xqhlshlhs5g0acqgrkafdemvf5kz4pp4c2x259\n')),(0,a.kt)("p",null,"Note that the ",(0,a.kt)("inlineCode",{parentName:"p"},"1 day")," lock ID did not display because, if the unbonding time began counting down from the time the command was executed, the bonding period would be complete before the two day window given by the UNIX timestamp input. Additionally, neither of the ",(0,a.kt)("inlineCode",{parentName:"p"},"1 day")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"1 week")," lock IDs for gamm/pool/1 showed due to the denom filter.\n:::"),(0,a.kt)("h3",{id:"account-locked-pasttime-not-unlocking"},"account-locked-pasttime-not-unlocking"),(0,a.kt)("p",null,"Query the locked records of an account with the unlock time beyond timestamp (unix) AND is not in the process of unlocking"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query lockup account-locked-pasttime [address] [timestamp]\n")),(0,a.kt)("p",null,"::: details Example"),(0,a.kt)("p",null,"Here is an example of an account that is locked in both the ",(0,a.kt)("inlineCode",{parentName:"p"},"1 day")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"1 week")," gamm/pool/3. In this example, the UNIX time is currently ",(0,a.kt)("inlineCode",{parentName:"p"},"1639776682")," and queries an ",(0,a.kt)("inlineCode",{parentName:"p"},"ADDRESS")," for UNIX time two days later from the current time (which in this example would be ",(0,a.kt)("inlineCode",{parentName:"p"},"1639971082"),") AND is not unlocking:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"osmosisd query lockup account-locked-pasttime osmo1xqhlshlhs5g0acqgrkafdemvf5kz4pp4c2x259 1639971082\n")),(0,a.kt)("p",null,"The example output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'locks:\n- ID: "572027"\n  coins:\n  - amount: "16120691802759484268"\n    denom: gamm/pool/3\n  duration: 604800.000006193s\n  end_time: "0001-01-01T00:00:00Z"\n  owner: osmo1xqhlshlhs5g0acqgrkafdemvf5kz4pp4c2x259\n')),(0,a.kt)("p",null,"Note that the ",(0,a.kt)("inlineCode",{parentName:"p"},"1 day")," lock ID did not display because, if the unbonding time began counting down from the time the command was executed, the bonding period would be complete before the two day window given by the UNIX timestamp input. Additionally, if ID 572027 were to begin the unlocking process, the query would have returned blank.\n:::"),(0,a.kt)("h3",{id:"account-unlockable-coins"},"account-unlockable-coins"),(0,a.kt)("p",null,"Query an address's LP shares that have completed the unlocking period and are ready to be withdrawn"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"osmosisd query lockup account-unlockable-coins ADDRESS\n")),(0,a.kt)("h3",{id:"account-unlocking-coins"},"account-unlocking-coins"),(0,a.kt)("p",null,"Query an address's LP shares that are currently unlocking"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query lockup account-unlocking-coins [address]\n")),(0,a.kt)("p",null,"::: details Example"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"osmosisd query lockup account-unlocking-coins osmo1xqhlshlhs5g0acqgrkafdemvf5kz4pp4c2x259\n")),(0,a.kt)("p",null,"Example output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'coins:\n- amount: "15527546134174465309"\n  denom: gamm/pool/3\n')),(0,a.kt)("p",null,":::"),(0,a.kt)("h3",{id:"lock-by-id"},"lock-by-id"),(0,a.kt)("p",null,"Query a lock record by its ID"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query lockup lock-by-id [id]\n")),(0,a.kt)("p",null,"::: details Example"),(0,a.kt)("p",null,"Every time a user bonds tokens to an LP, a unique lock ID is created for that transaction."),(0,a.kt)("p",null,"Here is an example viewing the lock record for ID 9:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"osmosisd query lockup lock-by-id 9\n")),(0,a.kt)("p",null,"And its output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'lock:\n  ID: "9"\n  coins:\n  - amount: "2449472670508255020346507"\n    denom: gamm/pool/2\n  duration: 336h\n  end_time: "0001-01-01T00:00:00Z"\n  owner: osmo16r39ghhwqjcwxa8q3yswlz8jhzldygy66vlm82\n')),(0,a.kt)("p",null,"In summary, this shows wallet ",(0,a.kt)("inlineCode",{parentName:"p"},"osmo16r39ghhwqjcwxa8q3yswlz8jhzldygy66vlm82")," bonded ",(0,a.kt)("inlineCode",{parentName:"p"},"2449472.670 gamm/pool/2")," LP shares for a ",(0,a.kt)("inlineCode",{parentName:"p"},"2 week")," locking period.\n:::"),(0,a.kt)("h3",{id:"module-balance"},"module-balance"),(0,a.kt)("p",null,"Query the balance of all LP shares (bonded and unbonded)"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query lockup module-balance\n")),(0,a.kt)("p",null,"::: details Example"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"osmosisd query lockup module-balance\n")),(0,a.kt)("p",null,"An example output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'coins:\n- amount: "118851922644152734549498647"\n  denom: gamm/pool/1\n- amount: "2165392672114512349039263626"\n  denom: gamm/pool/10\n- amount: "9346769826591025900804"\n  denom: gamm/pool/13\n- amount: "229347389639275840044722315"\n  denom: gamm/pool/15\n- amount: "81217698776012800247869"\n  denom: gamm/pool/183\n- amount: "284253336860259874753775"\n  denom: gamm/pool/197\n- amount: "664300804648059580124426710"\n  denom: gamm/pool/2\n- amount: "5087102794776326441530430"\n  denom: gamm/pool/22\n- amount: "178900843925960029029567880"\n  denom: gamm/pool/3\n- amount: "64845148811263846652326124"\n  denom: gamm/pool/4\n- amount: "177831279847453210600513"\n  denom: gamm/pool/42\n- amount: "18685913727862493301261661338"\n  denom: gamm/pool/5\n- amount: "23579028640963777558149250419"\n  denom: gamm/pool/6\n- amount: "1273329284855460149381904976"\n  denom: gamm/pool/7\n- amount: "625252103927082207683116933"\n  denom: gamm/pool/8\n- amount: "1148475247281090606949382402"\n  denom: gamm/pool/9\n')),(0,a.kt)("p",null,":::"),(0,a.kt)("h3",{id:"module-locked-amount"},"module-locked-amount"),(0,a.kt)("p",null,"Query the balance of all bonded LP shares"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query lockup module-locked-amount\n")),(0,a.kt)("p",null,"::: details Example"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"osmosisd query lockup module-locked-amount\n")),(0,a.kt)("p",null,"An example output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'\n  "coins":\n    {\n      "denom": "gamm/pool/1",\n      "amount": "247321084020868094262821308"\n    },\n    {\n      "denom": "gamm/pool/10",\n      "amount": "2866946821820635047398966697"\n    },\n    {\n      "denom": "gamm/pool/13",\n      "amount": "9366580741745176812984"\n    },\n    {\n      "denom": "gamm/pool/15",\n      "amount": "193294911294343602187680438"\n    },\n    {\n      "denom": "gamm/pool/183",\n      "amount": "196722012808526595790871"\n    },\n    {\n      "denom": "gamm/pool/197",\n      "amount": "1157025085661167198918241"\n    },\n    {\n      "denom": "gamm/pool/2",\n      "amount": "633051132033131378888258047"\n    },\n    {\n      "denom": "gamm/pool/22",\n      "amount": "3622601406125950733194696"\n    },\n...\n\n')),(0,a.kt)("p",null,"NOTE: This command seems to only work on gRPC and on CLI returns an EOF error.\n:::"),(0,a.kt)("h3",{id:"output-all-locks"},"output-all-locks"),(0,a.kt)("p",null,"Output all locks into a json file"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query lockup output-all-locks [max lock ID]\n")),(0,a.kt)("p",null,":::: details Example"),(0,a.kt)("p",null,"This example command outputs locks 1-1000 and saves to a json file:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"osmosisd query lockup output-all-locks 1000\n")),(0,a.kt)("p",null,'::: warning Note\nIf a lockup has been completed, the lockup status will show as "0" (or successful) and no further information will be available. To get further information on a completed lock, run the lock-by-id query.\n:::\n::::'),(0,a.kt)("h3",{id:"total-locked-of-denom"},"total-locked-of-denom"),(0,a.kt)("p",null,"Query locked amount for a specific denom in the duration provided"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query lockup total-locked-of-denom [denom] --min-duration\n")),(0,a.kt)("p",null,":::: details Example"),(0,a.kt)("p",null,"This example command outputs the amount of ",(0,a.kt)("inlineCode",{parentName:"p"},"gamm/pool/2")," LP shares that locked in the ",(0,a.kt)("inlineCode",{parentName:"p"},"2 week")," bonding period:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'osmosisd query lockup total-locked-of-denom gamm/pool/2 --min-duration "336h"\n')),(0,a.kt)("p",null,"Which, at the time of this writing outputs ",(0,a.kt)("inlineCode",{parentName:"p"},"14106985399822075248947045")," which is equivalent to ",(0,a.kt)("inlineCode",{parentName:"p"},"14106985.3998 gamm/pool/2")),(0,a.kt)("p",null,"NOTE: As of this writing, there is a bug that defaults the min duration to days instead of seconds. Ensure you specify the time in seconds to get the correct response.\n:::"),(0,a.kt)("h2",{id:"commands"},"Commands"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},'# 1 day 100stake lock-tokens command\nosmosisd tx lockup lock-tokens 200stake --duration="86400s" --from=validator --chain-id=testing --keyring-backend=test --yes\n\n# 5s 100stake lock-tokens command\nosmosisd tx lockup lock-tokens 100stake --duration="5s" --from=validator --chain-id=testing --keyring-backend=test --yes\n\n# begin unlock tokens, NOTE: add more gas when unlocking more than two locks in a same command\nosmosisd tx lockup begin-unlock-tokens --from=validator --gas=500000 --chain-id=testing --keyring-backend=test --yes\n\n# unlock tokens, NOTE: add more gas when unlocking more than two locks in a same command\nosmosisd tx lockup unlock-tokens --from=validator --gas=500000 --chain-id=testing --keyring-backend=test --yes\n\n# unlock specific period lock\nosmosisd tx lockup unlock-by-id 1 --from=validator --chain-id=testing --keyring-backend=test --yes\n\n# account balance\nosmosisd query bank balances $(osmosisd keys show -a validator --keyring-backend=test)\n\n# query module balance\nosmosisd query lockup module-balance\n\n# query locked amount\nosmosisd query lockup module-locked-amount\n\n# query lock by id\nosmosisd query lockup lock-by-id 1\n\n# query account unlockable coins\nosmosisd query lockup account-unlockable-coins $(osmosisd keys show -a validator --keyring-backend=test)\n\n# query account locks by denom past time\nosmosisd query lockup account-locked-pasttime-denom $(osmosisd keys show -a validator --keyring-backend=test) 1611879610 stake\n\n# query account locks past time\nosmosisd query lockup account-locked-pasttime $(osmosisd keys show -a validator --keyring-backend=test) 1611879610\n\n# query account locks by denom with longer duration\nosmosisd query lockup account-locked-longer-duration-denom $(osmosisd keys show -a validator --keyring-backend=test) 5.1s stake\n\n# query account locks with longer duration\nosmosisd query lockup account-locked-longer-duration $(osmosisd keys show -a validator --keyring-backend=test) 5.1s\n\n# query account locked coins\nosmosisd query lockup account-locked-coins $(osmosisd keys show -a validator --keyring-backend=test)\n\n# query account locks before time\nosmosisd query lockup account-locked-beforetime $(osmosisd keys show -a validator --keyring-backend=test) 1611879610\n')))}d.isMDXComponent=!0}}]);