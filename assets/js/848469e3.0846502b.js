"use strict";(self.webpackChunkosmosis_docs=self.webpackChunkosmosis_docs||[]).push([[3949],{3905:(e,t,a)=>{a.d(t,{Zo:()=>m,kt:()=>h});var o=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,o,n=function(e,t){if(null==e)return{};var a,o,n={},i=Object.keys(e);for(o=0;o<i.length;o++)a=i[o],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)a=i[o],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var r=o.createContext({}),p=function(e){var t=o.useContext(r),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},m=function(e){var t=p(e.components);return o.createElement(r.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,r=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),d=p(a),h=n,k=d["".concat(r,".").concat(h)]||d[h]||u[h]||i;return a?o.createElement(k,l(l({ref:t},m),{},{components:a})):o.createElement(k,l({ref:t},m))}));function h(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,l=new Array(i);l[0]=d;var s={};for(var r in t)hasOwnProperty.call(t,r)&&(s[r]=t[r]);s.originalType=e,s.mdxType="string"==typeof e?e:n,l[1]=s;for(var p=2;p<i;p++)l[p]=a[p];return o.createElement.apply(null,l)}return o.createElement.apply(null,a)}d.displayName="MDXCreateElement"},32093:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>r,contentTitle:()=>l,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>p});var o=a(87462),n=(a(67294),a(3905));const i={},l="GAMM",s={unversionedId:"modules/gamm/README",id:"modules/gamm/README",title:"GAMM",description:"The `GAMM` module (Generalized Automated Market Maker) provides the logic to create and interact with liquidity pools on the Osmosis DEX.",source:"@site/docs/osmosis-core/modules/gamm/README.md",sourceDirName:"modules/gamm",slug:"/modules/gamm/",permalink:"/osmosis-core/modules/gamm/",draft:!1,editUrl:"https://github.com/osmosis-labs/docs/tree/main/docs/osmosis-core/modules/gamm/README.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Epochs",permalink:"/osmosis-core/modules/epochs/"},next:{title:"CLI docs",permalink:"/osmosis-core/modules/gamm/client/docs/"}},r={},p=[{value:"Contents",id:"contents",level:2},{value:"Concepts",id:"concepts",level:2},{value:"Pool",id:"pool",level:3},{value:"Creation of Pool",id:"creation-of-pool",level:4},{value:"Joining Pool",id:"joining-pool",level:4},{value:"Join types code call stack and structure:",id:"join-types-code-call-stack-and-structure",level:4},{value:"Exiting Pool",id:"exiting-pool",level:4},{value:"Exit types code call stack and structure:",id:"exit-types-code-call-stack-and-structure",level:4},{value:"Swap",id:"swap",level:3},{value:"Spot Price",id:"spot-price",level:4},{value:"Multi-Hop",id:"multi-hop",level:4},{value:"Weights",id:"weights",level:2},{value:"Network Parameters",id:"network-parameters",level:2},{value:"Migration Records",id:"migration-records",level:2},{value:"Messages",id:"messages",level:2},{value:"MsgCreateBalancerPool",id:"msgcreatebalancerpool",level:3},{value:"MsgJoinPool",id:"msgjoinpool",level:3},{value:"MsgExitPool",id:"msgexitpool",level:3},{value:"MsgSwapExactAmountIn",id:"msgswapexactamountin",level:3},{value:"MsgSwapExactAmountOut",id:"msgswapexactamountout",level:3},{value:"MsgJoinSwapExternAmountIn",id:"msgjoinswapexternamountin",level:3},{value:"MsgJoinSwapShareAmountOut",id:"msgjoinswapshareamountout",level:4},{value:"MsgExitSwapShareAmountIn",id:"msgexitswapshareamountin",level:4},{value:"MsgExitSwapExternAmountOut",id:"msgexitswapexternamountout",level:4},{value:"Transactions",id:"transactions",level:2},{value:"Create pool",id:"create-pool",level:3},{value:"Join pool",id:"join-pool",level:3},{value:"Exit pool",id:"exit-pool",level:3},{value:"Join-swap-extern-amount-in",id:"join-swap-extern-amount-in",level:3},{value:"Exit-swap-extern-amount-out",id:"exit-swap-extern-amount-out",level:3},{value:"Join-swap-share-amount-out",id:"join-swap-share-amount-out",level:3},{value:"Exit-swap-share-amount-in",id:"exit-swap-share-amount-in",level:3},{value:"Swap-exact-amount-in",id:"swap-exact-amount-in",level:3},{value:"Swap-exact-amount-out",id:"swap-exact-amount-out",level:3},{value:"Queries",id:"queries",level:2},{value:"Queries",id:"queries-1",level:2},{value:"Estimate Swap Exact Amount In",id:"estimate-swap-exact-amount-in",level:3},{value:"Usage",id:"usage",level:4},{value:"Example",id:"example",level:4},{value:"Estimate Swap Exact Amount Out",id:"estimate-swap-exact-amount-out",level:3},{value:"Usage",id:"usage-1",level:4},{value:"Example",id:"example-1",level:4},{value:"Num Pools",id:"num-pools",level:3},{value:"Usage",id:"usage-2",level:4},{value:"Pool",id:"pool-1",level:2},{value:"Usage",id:"usage-3",level:3},{value:"Example",id:"example-2",level:3},{value:"Pool Assets",id:"pool-assets",level:3},{value:"Usage",id:"usage-4",level:4},{value:"Example",id:"example-3",level:4},{value:"Pool Params",id:"pool-params",level:3},{value:"Usage",id:"usage-5",level:4},{value:"Example",id:"example-4",level:4},{value:"Pools",id:"pools",level:3},{value:"Usage",id:"usage-6",level:4},{value:"Total Liquidity",id:"total-liquidity",level:3},{value:"Usage",id:"usage-7",level:4},{value:"Total Share",id:"total-share",level:3},{value:"Usage",id:"usage-8",level:4},{value:"Example",id:"example-5",level:4},{value:"Other resources",id:"other-resources",level:2},{value:"Events",id:"events",level:2},{value:"<code>sdk.EventTypeMessage</code>",id:"sdkeventtypemessage",level:3},{value:"<code>types.TypeEvtPoolJoined</code>",id:"typestypeevtpooljoined",level:3},{value:"<code>types.TypeEvtPoolExited</code>",id:"typestypeevtpoolexited",level:3},{value:"<code>types.TypeEvtPoolCreated</code>",id:"typestypeevtpoolcreated",level:3},{value:"<code>types.TypeEvtTokenSwapped</code>",id:"typestypeevttokenswapped",level:3}],m={toc:p};function u(e){let{components:t,...a}=e;return(0,n.kt)("wrapper",(0,o.Z)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"gamm"},"GAMM"),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},"GAMM")," module (",(0,n.kt)("strong",{parentName:"p"},"G"),"eneralized ",(0,n.kt)("strong",{parentName:"p"},"A"),"utomated ",(0,n.kt)("strong",{parentName:"p"},"M"),"arket ",(0,n.kt)("strong",{parentName:"p"},"M"),"aker) provides the logic to create and interact with liquidity pools on the Osmosis DEX."),(0,n.kt)("h2",{id:"contents"},"Contents"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},(0,n.kt)("a",{parentName:"strong",href:"#concepts"},"Concepts"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},(0,n.kt)("a",{parentName:"strong",href:"#weights"},"Weights"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},(0,n.kt)("a",{parentName:"strong",href:"#network-parameters"},"Pool Parameters"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},(0,n.kt)("a",{parentName:"strong",href:"#messages"},"Messages"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},(0,n.kt)("a",{parentName:"strong",href:"#transactions"},"Transactions"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},(0,n.kt)("a",{parentName:"strong",href:"#queries-and-transactions"},"Queries and Transactions")))),(0,n.kt)("h2",{id:"concepts"},"Concepts"),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},"x/gamm")," module implements an AMM using:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Balancer style pools with varying amounts and weights of assets in pools."),(0,n.kt)("li",{parentName:"ul"},"Stableswap pools have liquidity centered around a given spot price. See ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/osmosis-labs/osmosis/blob/main/x/gamm/pool-models/stableswap/README.md"},"here")," for the spec of the Osmosis implementation.")),(0,n.kt)("p",null,"Here we will explain basic GAMM concepts and give an overview of how GAMM module's code is organized to support both type of pools."),(0,n.kt)("h3",{id:"pool"},"Pool"),(0,n.kt)("h4",{id:"creation-of-pool"},"Creation of Pool"),(0,n.kt)("p",null,"At an initial creation of the pool, a fixed amount of 100 share token is\nminted in the pool and sent to the creator of the pool's account. The\npool share denom is in the format of ",(0,n.kt)("inlineCode",{parentName:"p"},"gamm/pool/{poolID}")," and is\ndisplayed in the format of ",(0,n.kt)("inlineCode",{parentName:"p"},"GAMM-{poolID}")," to the user.\nPool assets are sorted in alphabetical order by default.\nPool creation is possible only for at least 2 and no more than 8 denominations."),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"PoolCreationFee")," needs to be paid to create the pool. This also keeps\nus safe when it comes to the malicious creation of unneeded pools."),(0,n.kt)("h4",{id:"joining-pool"},"Joining Pool"),(0,n.kt)("p",null,"When joining a pool without swapping - with ",(0,n.kt)("inlineCode",{parentName:"p"},"JoinPool"),", a user can provide the maximum amount of tokens ",(0,n.kt)("inlineCode",{parentName:"p"},"TokenInMaxs'\nthey're willing to deposit. This argument must contain all the denominations from the pool or no tokens at all, \notherwise, the tx will be aborted.\nIf "),"TokenInMaxs` contains no tokens, the calculations are done based on the user's balance as the only constraint."),(0,n.kt)("p",null,"The front end takes care of the\ncalculation of how many share tokens the user is eligible for at the\nspecific moment of sending the transaction."),(0,n.kt)("p",null,"Calculation of exactly how many tokens are needed to get the designated\nshare is done at the moment of processing the transaction, validating\nthat it does not exceed the maximum amount of tokens the user is willing\nto deposit. After the validation, GAMM share tokens of the pool are\nminted and sent to the user's account."),(0,n.kt)("p",null,"Joining the pool using a single asset is also possible with ",(0,n.kt)("inlineCode",{parentName:"p"},"JoinSwapExternAmountIn"),"."),(0,n.kt)("p",null,"Existing Join types:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"JoinPool"),(0,n.kt)("li",{parentName:"ul"},"JoinSwapExternAmountIn"),(0,n.kt)("li",{parentName:"ul"},"JoinSwapShareAmountOut")),(0,n.kt)("h4",{id:"join-types-code-call-stack-and-structure"},"Join types code call stack and structure:"),(0,n.kt)("img",{src:"GAMM_JoinPoolMsgs.png",height:"500"}),(0,n.kt)("br",null),(0,n.kt)("h4",{id:"exiting-pool"},"Exiting Pool"),(0,n.kt)("p",null,"When exiting a pool, the user provides the minimum amount of tokens they\nare willing to receive as they are returning their shares of the pool.\nHowever, unlike joining a pool, exiting a pool requires the user to pay\nthe exit fee, which is set as a param of the pool. The user's share\ntokens burnt as result. Exiting the pool using a single asset is also\npossible."),(0,n.kt)("p",null,'Exiting a pool is possible only if user will leave a positive balance for a certain denomination after exiting\nor positive number of LP shares.\nOtherwise transaction will be aborted and user will not be able to exit a pool.\nTherefore, it is not possible to "drain out" a pool.'),(0,n.kt)("p",null,"When exiting a pool with a swap, both exit and swap fees are paid."),(0,n.kt)("p",null,"Existing Exit types:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"ExitPool"),(0,n.kt)("li",{parentName:"ul"},"ExitSwapExternAmountOut"),(0,n.kt)("li",{parentName:"ul"},"ExitSwapShareAmountIn")),(0,n.kt)("h4",{id:"exit-types-code-call-stack-and-structure"},"Exit types code call stack and structure:"),(0,n.kt)("img",{src:"GAMM_ExitPoolMsgs.png",height:"500"}),(0,n.kt)("br",null),(0,n.kt)("h3",{id:"swap"},"Swap"),(0,n.kt)("p",null,"During the process of swapping a specific asset, the token the user is\nputting into the pool is denoted as ",(0,n.kt)("inlineCode",{parentName:"p"},"tokenIn"),", while the token that\nwould be returned to the user, the asset that is being swapped for,\nafter the swap is denoted as ",(0,n.kt)("inlineCode",{parentName:"p"},"tokenOut")," throughout the module."),(0,n.kt)("p",null,"Given a ",(0,n.kt)("inlineCode",{parentName:"p"},"tokenIn"),", the following calculations are done to calculate how\nmany tokens are to be swapped into and removed from the pool:"),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"tokenBalanceOut * [1 - { tokenBalanceIn / (tokenBalanceIn + (1 - swapFee) * tokenAmountIn)} ^ (tokenWeightIn / tokenWeightOut)]")),(0,n.kt)("p",null,"The calculation is also able to be reversed, the case where user\nprovides ",(0,n.kt)("inlineCode",{parentName:"p"},"tokenOut"),". The calculation for the amount of tokens that the\nuser should be putting in is done through the following formula:"),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"tokenBalanceIn * [{tokenBalanceOut / (tokenBalanceOut - tokenAmountOut)} ^ (tokenWeightOut / tokenWeightIn) -1] / tokenAmountIn")),(0,n.kt)("p",null,"Existing Swap types:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"SwapExactAmountIn"),(0,n.kt)("li",{parentName:"ul"},"SwapExactAmountOut")),(0,n.kt)("h4",{id:"spot-price"},"Spot Price"),(0,n.kt)("p",null,"Meanwhile, calculation of the spot price with a swap fee is done using\nthe following formula:"),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"spotPrice / (1 - swapFee)"),", where ",(0,n.kt)("inlineCode",{parentName:"p"},"spotPrice")," is defined as:"),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"(tokenBalanceIn / tokenWeightIn) / (tokenBalanceOut / tokenWeightOut)")),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://github.com/osmosis-labs/osmosis/blob/main/x/gamm/keeper/swap.go"},"Spot price")),(0,n.kt)("h4",{id:"multi-hop"},"Multi-Hop"),(0,n.kt)("p",null,"The multi-hop logic is handled via ",(0,n.kt)("inlineCode",{parentName:"p"},"x/poolmanager")," module.\nPlease see for details:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://github.com/osmosis-labs/osmosis/blob/main/x/poolmanager/README.md"},"https://github.com/osmosis-labs/osmosis/blob/main/x/poolmanager/README.md"))),(0,n.kt)("h2",{id:"weights"},"Weights"),(0,n.kt)("p",null,'Weights refer to the how we weight the reserves of assets within a pool.\nIts often convenient to think of weights in terms of ratios, so a 1:1\npool between "ATOM" and "BTC" is a pool where the spot price is\n',(0,n.kt)("inlineCode",{parentName:"p"},"#ATOM in pool / #BTC in pool"),"."),(0,n.kt)("p",null,"A 2:1 pool is one where the spot price is\n",(0,n.kt)("inlineCode",{parentName:"p"},"2*(#ATOM in pool) / #BTC in pool"),". This weights allows one to get the\nsame spot price in the pool, with fewer ATOM reserves. (This comes at\nthe cost of having higher slippage, e.g.\xa0buying 10 atoms moves the price\nmore than a 1:1 pool with the same BTC liquidity)."),(0,n.kt)("p",null,"Within the state machine, we represent weights as numbers, and the\nratios are computed internally. So you could specify a pool between\nthree assets, with weights 100:30:50, which is equivalent to a 10:3:5\npool."),(0,n.kt)("p",null,"The ratios provided in a CreatePool message, or governance proposal are\ncapped at 2\\^20. However, within the state machine they are stored with\nan extra 30 bits of precision, allowing for smooth changes between two\nweights to happen with sufficient granularity."),(0,n.kt)("p",null,"(Note, these docs are intended to get shuffled around as we write more\nof the spec for x/gamm. I just wanted to document this along with the\nPR, to save work for our future selves)"),(0,n.kt)("h2",{id:"network-parameters"},"Network Parameters"),(0,n.kt)("p",null,"Pools have the following parameters:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:null},"Key"),(0,n.kt)("th",{parentName:"tr",align:null},"Type"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"SwapFee"),(0,n.kt)("td",{parentName:"tr",align:null},"sdk.Dec")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"ExitFee"),(0,n.kt)("td",{parentName:"tr",align:null},"sdk.Dec")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"FutureGovernor"),(0,n.kt)("td",{parentName:"tr",align:null},"*","FutureGovernor")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"Weights"),(0,n.kt)("td",{parentName:"tr",align:null},"*","Weights")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"SmoothWeightChangeParams"),(0,n.kt)("td",{parentName:"tr",align:null},"*","SmoothWeightChangeParams")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"PoolCreationFee"),(0,n.kt)("td",{parentName:"tr",align:null},"sdk.Coins")))),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"SwapFee")," -\nThe swap fee is the cut of all swaps that goes to the Liquidity Providers (LPs) for a pool. Suppose a pool has a swap fee ",(0,n.kt)("inlineCode",{parentName:"li"},"s"),". Then if a user wants to swap ",(0,n.kt)("inlineCode",{parentName:"li"},"T")," tokens in the pool, ",(0,n.kt)("inlineCode",{parentName:"li"},"sT")," tokens go to the LP's, and then ",(0,n.kt)("inlineCode",{parentName:"li"},"(1 - s)T")," tokens are swapped according to the AMM swap function."),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"ExitFee")," -\nThe exit fee is a fee that is applied to LP's that want to remove their liquidity from the pool. Suppose a pool has an exit fee ",(0,n.kt)("inlineCode",{parentName:"li"},"e"),". If they currently have ",(0,n.kt)("inlineCode",{parentName:"li"},"S")," LP shares, then when they remove their liquidity they get tokens worth ",(0,n.kt)("inlineCode",{parentName:"li"},"(1 - e)S")," shares back. The remaining ",(0,n.kt)("inlineCode",{parentName:"li"},"eS")," shares are then burned, and the tokens corresponding to these shares are kept as liquidity."),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"FutureGovernor")," -\nOsmosis plans to allow every pool to act as a DAO, with its own governance in a future upgrade. To facilitate this transition, we allow pools to specify who the governor should be as a string. There are currently 3 options for the future governor.",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"No one will govern it. This is done by leaving the future governor string as blank."),(0,n.kt)("li",{parentName:"ul"},"Allow a given address to govern it. This is done by setting the future governor as a bech32 address."),(0,n.kt)("li",{parentName:"ul"},"Lockups to a token. This is the full DAO scenario. The future governor specifies a token denomination ",(0,n.kt)("inlineCode",{parentName:"li"},"denom"),", and a lockup duration ",(0,n.kt)("inlineCode",{parentName:"li"},"duration"),'. This says that "all tokens of denomination ',(0,n.kt)("inlineCode",{parentName:"li"},"denom")," that are locked up for ",(0,n.kt)("inlineCode",{parentName:"li"},"duration"),' or longer, have equal say in governance of this pool".'))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Weights")," -\nThis defines the weights of the pool - ",(0,n.kt)("a",{parentName:"li",href:"https://balancer.fi/whitepaper.pdf"},"https://balancer.fi/whitepaper.pdf")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"SmoothWeightChangeParams")," -\nThis allows pool governance to smoothly change the weights of the assets it holds in the pool. So it can slowly move from a 2:1 ratio, to a 1:1 ratio.\nCurrently, smooth weight changes are implemented as a linear change in weight ratios over a given duration of time. So weights changed from 4:1 to 2:2 over 2 days, then at day 1 of the change, the weights would be 3:1.5, and at day 2 its 2:2, and will remain at these weight ratios.")),(0,n.kt)("p",null,"The GAMM module also has a ",(0,n.kt)("strong",{parentName:"p"},"PoolCreationFee")," parameter, which currently is set to ",(0,n.kt)("inlineCode",{parentName:"p"},"20000000 uusdc")," or ",(0,n.kt)("inlineCode",{parentName:"p"},"20 USDC"),"."),(0,n.kt)("h2",{id:"migration-records"},"Migration Records"),(0,n.kt)("p",null,"Migration records are used to track a canonical link between a single balancer pool and its corresponding concentrated liquidity pool. There is a single ",(0,n.kt)("inlineCode",{parentName:"p"},"MigrationRecords")," object for the entire gamm module that consists of many ",(0,n.kt)("inlineCode",{parentName:"p"},"BalancerToConcentratedPoolLink")," objects. Each balancer pool can be linked to a maximum of one concentrated liquidity pool, and each concentrated liquidity pool can be linked to a maximum of one balancer pool. The entire ",(0,n.kt)("inlineCode",{parentName:"p"},"MigrationRecords")," object can be either replaced through governance via ",(0,n.kt)("inlineCode",{parentName:"p"},"ReplaceMigrationRecordsProposal")," or specific pool links can be added/removed/modified through governance via ",(0,n.kt)("inlineCode",{parentName:"p"},"UpdateMigrationRecordsProposal")," (similar to how incentives are replaced and updated)."),(0,n.kt)("br",null),(0,n.kt)("br",null),(0,n.kt)("h2",{id:"messages"},"Messages"),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},"x/gamm")," module supports the following message types:"),(0,n.kt)("h3",{id:"msgcreatebalancerpool"},"MsgCreateBalancerPool"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://github.com/osmosis-labs/osmosis/blob/v7.1.0/proto/osmosis/gamm/pool-models/balancer/tx.proto#L16-L26"},"MsgCreateBalancerPool")),(0,n.kt)("h3",{id:"msgjoinpool"},"MsgJoinPool"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://github.com/osmosis-labs/osmosis/blob/v7.1.0/proto/osmosis/gamm/v1beta1/tx.proto#L27-L39"},"MsgJoinPool")),(0,n.kt)("h3",{id:"msgexitpool"},"MsgExitPool"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://github.com/osmosis-labs/osmosis/blob/v7.1.0/proto/osmosis/gamm/v1beta1/tx.proto#L44-L57"},"MsgExitPool")),(0,n.kt)("h3",{id:"msgswapexactamountin"},"MsgSwapExactAmountIn"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://github.com/osmosis-labs/osmosis/blob/v7.1.0/proto/osmosis/gamm/v1beta1/tx.proto#L68-L80"},"MsgSwapExactAmountIn")),(0,n.kt)("p",null,"Note, that this message was deprecated and moved to ",(0,n.kt)("inlineCode",{parentName:"p"},"x/poolmanager"),". Please use the ",(0,n.kt)("inlineCode",{parentName:"p"},"MsgSwapExactAmountIn")," message\nin ",(0,n.kt)("inlineCode",{parentName:"p"},"x/poolmanager")," instead."),(0,n.kt)("h3",{id:"msgswapexactamountout"},"MsgSwapExactAmountOut"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://github.com/osmosis-labs/osmosis/blob/v7.1.0/proto/osmosis/gamm/v1beta1/tx.proto#L90-L102"},"MsgSwapExactAmountOut")),(0,n.kt)("p",null,"Note, that this message was deprecated and moved to ",(0,n.kt)("inlineCode",{parentName:"p"},"x/poolmanager"),". Please use the ",(0,n.kt)("inlineCode",{parentName:"p"},"MsgSwapExactAmountOut")," message\nin ",(0,n.kt)("inlineCode",{parentName:"p"},"x/poolmanager")," instead."),(0,n.kt)("h3",{id:"msgjoinswapexternamountin"},"MsgJoinSwapExternAmountIn"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://github.com/osmosis-labs/osmosis/blob/v7.1.0/proto/osmosis/gamm/v1beta1/tx.proto#L107-L119"},"MsgJoinSwapExternAmountIn")),(0,n.kt)("h4",{id:"msgjoinswapshareamountout"},"MsgJoinSwapShareAmountOut"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://github.com/osmosis-labs/osmosis/blob/v7.1.0/proto/osmosis/gamm/v1beta1/tx.proto#L124-L138"},"MsgJoinSwapShareAmountOut")),(0,n.kt)("h4",{id:"msgexitswapshareamountin"},"MsgExitSwapShareAmountIn"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://github.com/osmosis-labs/osmosis/blob/v7.1.0/proto/osmosis/gamm/v1beta1/tx.proto#L143-L158"},"MsgExitSwapShareAmountIn")),(0,n.kt)("h4",{id:"msgexitswapexternamountout"},"MsgExitSwapExternAmountOut"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://github.com/osmosis-labs/osmosis/blob/v7.1.0/proto/osmosis/gamm/v1beta1/tx.proto#L163-L175"},"MsgExitSwapExternAmountOut")),(0,n.kt)("h2",{id:"transactions"},"Transactions"),(0,n.kt)("h3",{id:"create-pool"},"Create pool"),(0,n.kt)("p",null,"Create a new liquidity pool and provide initial liquidity to it."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd tx gamm create-pool [config-file] --from --chain-id\n")),(0,n.kt)("p",null,"::: details Example\nThe JSON ","[config-file]"," must specify the following parameters:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-json"},'{\n "weights": [list weighted denoms],\n "initial-deposit": [list of denoms with initial deposit amount],\n "swap-fee": [swap fee in percentage],\n "exit-fee": [exit fee in percentage],\n "future-governor": [see options in pool parameters section above]\n}\n')),(0,n.kt)("p",null,"Create a new 50/50 AKT-OSMO liquidity pool with a swap and exit fee of 1%."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd tx gamm create-pool --pool-file [config-file] --from WALLET_NAME --chain-id osmosis-1\n")),(0,n.kt)("p",null,"The configuration json file contains the following parameters:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-json"},'{\n "weights": "5ibc/1480B8FD20AD5FCAE81EA87584D269547DD4D436843C1D20F15E00EB64743EF4,5uosmo",\n "initial-deposit": "499404ibc/1480B8FD20AD5FCAE81EA87584D269547DD4D436843C1D20F15E00EB64743EF4,500000uosmo",\n "swap-fee": "0.01",\n "exit-fee": "0.01",\n "future-governor": ""\n}\n')),(0,n.kt)("p",null,":::"),(0,n.kt)("p",null,"::: warning\nThere is now a 20 USDC fee for creating pools.\n:::"),(0,n.kt)("h3",{id:"join-pool"},"Join pool"),(0,n.kt)("p",null,"Add liquidity to a specified pool to get an ",(0,n.kt)("strong",{parentName:"p"},"exact")," amount of LP shares while specifying a ",(0,n.kt)("strong",{parentName:"p"},"maximum")," number tokens willing to swap to receive said LP shares."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd tx gamm join-pool --pool-id --max-amounts-in --share-amount-out --from --chain-id\n")),(0,n.kt)("p",null,"::: details Example"),(0,n.kt)("p",null,"Join ",(0,n.kt)("inlineCode",{parentName:"p"},"pool 3")," with a ",(0,n.kt)("strong",{parentName:"p"},"maximum")," of ",(0,n.kt)("inlineCode",{parentName:"p"},".037753 AKT")," and the corresponding amount of ",(0,n.kt)("inlineCode",{parentName:"p"},"OSMO")," to get an ",(0,n.kt)("strong",{parentName:"p"},"exact")," share amount of ",(0,n.kt)("inlineCode",{parentName:"p"},"1.227549469722224220 gamm/pool/3")," using ",(0,n.kt)("inlineCode",{parentName:"p"},"WALLET_NAME")," on the osmosis mainnet:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd tx gamm join-pool --pool-id 3 --max-amounts-in 37753ibc/1480B8FD20AD5FCAE81EA87584D269547DD4D436843C1D20F15E00EB64743EF4 --share-amount-out 1227549469722224220 --from WALLET_NAME --chain-id osmosis-1\n")),(0,n.kt)("p",null,":::"),(0,n.kt)("h3",{id:"exit-pool"},"Exit pool"),(0,n.kt)("p",null,"Remove liquidity from a specified pool with an ",(0,n.kt)("strong",{parentName:"p"},"exact")," amount of LP shares while specifying the ",(0,n.kt)("strong",{parentName:"p"},"minimum")," number of tokens willing to receive for said LP shares."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd tx gamm exit-pool --pool-id --min-amounts-out --share-amount-in --from --chain-id\n")),(0,n.kt)("p",null,"::: details Example"),(0,n.kt)("p",null,"Exit ",(0,n.kt)("inlineCode",{parentName:"p"},"pool 3")," with for ",(0,n.kt)("strong",{parentName:"p"},"exactly")," ",(0,n.kt)("inlineCode",{parentName:"p"},"1.136326462628731195 gamm/pool/3")," in order to receive a ",(0,n.kt)("strong",{parentName:"p"},"minimum")," of ",(0,n.kt)("inlineCode",{parentName:"p"},".033358 AKT")," and the corresponding amount of ",(0,n.kt)("inlineCode",{parentName:"p"},"OSMO")," using ",(0,n.kt)("inlineCode",{parentName:"p"},"WALLET_NAME")," on the osmosis mainnet:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd tx gamm exit-pool --pool-id 3 --min-amounts-out 33358ibc/1480B8FD20AD5FCAE81EA87584D269547DD4D436843C1D20F15E00EB64743EF4 --share-amount-in 1136326462628731195 --from WALLET_NAME --chain-id osmosis-1\n")),(0,n.kt)("p",null,":::"),(0,n.kt)("h3",{id:"join-swap-extern-amount-in"},"Join-swap-extern-amount-in"),(0,n.kt)("p",null,"Add liquidity to a specified pool with only one of the required assets (i.e. Join pool 1 (50/50 ATOM-OSMO) with just ATOM)."),(0,n.kt)("p",null,"This command essentially swaps an ",(0,n.kt)("strong",{parentName:"p"},"exact")," amount of an asset for the required pairing and then converts the pair to a ",(0,n.kt)("strong",{parentName:"p"},"minimum")," of the requested LP shares in a single step (i.e. combines the ",(0,n.kt)("inlineCode",{parentName:"p"},"swap-exact-amount-in")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"join-pool")," commands)"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd tx gamm join-swap-extern-amount-in [token-in] [share-out-min-amount] --from --pool-id --chain-id\n")),(0,n.kt)("p",null,"::: details Example"),(0,n.kt)("p",null,"Join ",(0,n.kt)("inlineCode",{parentName:"p"},"pool 3")," with ",(0,n.kt)("strong",{parentName:"p"},"exactly")," ",(0,n.kt)("inlineCode",{parentName:"p"},".200000 AKT")," (and ",(0,n.kt)("inlineCode",{parentName:"p"},"0 OSMO"),") to get a ",(0,n.kt)("strong",{parentName:"p"},"minimum")," of ",(0,n.kt)("inlineCode",{parentName:"p"},"3.234812471272883046 gamm/pool/3")," using ",(0,n.kt)("inlineCode",{parentName:"p"},"WALLET_NAME")," on the osmosis mainnet:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd tx gamm join-swap-extern-amount-in 200000ibc/1480B8FD20AD5FCAE81EA87584D269547DD4D436843C1D20F15E00EB64743EF4 3234812471272883046 --pool-id 3 --from WALLET_NAME --chain-id osmosis-1\n")),(0,n.kt)("p",null,":::"),(0,n.kt)("h3",{id:"exit-swap-extern-amount-out"},"Exit-swap-extern-amount-out"),(0,n.kt)("p",null,"Remove liquidity from a specified pool with a ",(0,n.kt)("strong",{parentName:"p"},"maximum")," amount of LP shares and swap to an ",(0,n.kt)("strong",{parentName:"p"},"exact")," amount of one of the token pairs (i.e. Leave pool 1 (50/50 ATOM-OSMO) and receive 100% ATOM instead of 50% OSMO and 50% ATOM)."),(0,n.kt)("p",null,"This command essentially converts an LP share into the corresponding share of tokens and then swaps to the specified ",(0,n.kt)("inlineCode",{parentName:"p"},"token-out")," in a single step (i.e. combines the ",(0,n.kt)("inlineCode",{parentName:"p"},"swap-exact-amount-out")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"exit-pool")," commands)"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd tx gamm exit-swap-extern-amount-out [token-out] [share-in-max-amount] --pool-id --from --chain-id\n")),(0,n.kt)("p",null,"::: details Example"),(0,n.kt)("p",null,"Exit ",(0,n.kt)("inlineCode",{parentName:"p"},"pool 3")," by removing a ",(0,n.kt)("strong",{parentName:"p"},"maximum")," of ",(0,n.kt)("inlineCode",{parentName:"p"},"3.408979387886193586 gamm/pool/3")," and swap the ",(0,n.kt)("inlineCode",{parentName:"p"},"OSMO")," portion of the LP share to receive 100% AKT in the ",(0,n.kt)("strong",{parentName:"p"},"exact")," amount of ",(0,n.kt)("inlineCode",{parentName:"p"},"0.199430 AKT"),":"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd tx gamm exit-swap-extern-amount-out 199430ibc/1480B8FD20AD5FCAE81EA87584D269547DD4D436843C1D20F15E00EB64743EF4 3408979387886193586 --pool-id 3 --from WALLET_NAME --chain-id osmosis-1\n")),(0,n.kt)("p",null,":::"),(0,n.kt)("h3",{id:"join-swap-share-amount-out"},"Join-swap-share-amount-out"),(0,n.kt)("p",null,"Swap a ",(0,n.kt)("strong",{parentName:"p"},"maximum")," amount of a specified token for another token, similar to swapping a token on the trade screen GUI (i.e. takes the specified asset and swaps it to the other asset needed to join the specified pool) and then adds an ",(0,n.kt)("strong",{parentName:"p"},"exact")," amount of LP shares to the specified pool."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd tx gamm join-swap-share-amount-out [token-in-denom] [share-out-amount] [token-in-max-amount] --pool-id --from --chain-id\n")),(0,n.kt)("p",null,"::: details Example"),(0,n.kt)("p",null,"Swap a ",(0,n.kt)("strong",{parentName:"p"},"maximum")," of ",(0,n.kt)("inlineCode",{parentName:"p"},"0.312466 OSMO")," for the corresponding amount of ",(0,n.kt)("inlineCode",{parentName:"p"},"AKT"),", then join ",(0,n.kt)("inlineCode",{parentName:"p"},"pool 3")," and receive ",(0,n.kt)("strong",{parentName:"p"},"exactly")," ",(0,n.kt)("inlineCode",{parentName:"p"},"1.4481270389710236872 gamm/pool/3"),":"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd tx gamm join-swap-share-amount-out uosmo 14481270389710236872 312466 --pool-id 3 --from WALLET_NAME --chain-id osmosis-1\n")),(0,n.kt)("p",null,":::"),(0,n.kt)("h3",{id:"exit-swap-share-amount-in"},"Exit-swap-share-amount-in"),(0,n.kt)("p",null,"Remove an ",(0,n.kt)("strong",{parentName:"p"},"exact")," amount of LP shares from a specified pool, swap the LP shares to one of the token pairs to receive a ",(0,n.kt)("strong",{parentName:"p"},"minimum")," of the specified token amount."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd tx gamm exit-swap-share-amount-in [token-out-denom] [share-in-amount] [token-out-min-amount] --pool-id --from --chain-id\n")),(0,n.kt)("p",null,"::: details Example"),(0,n.kt)("p",null,"Exit ",(0,n.kt)("inlineCode",{parentName:"p"},"pool 3")," by removing ",(0,n.kt)("strong",{parentName:"p"},"exactly")," ",(0,n.kt)("inlineCode",{parentName:"p"},"14.563185400026723131 gamm/pool/3")," and swap the ",(0,n.kt)("inlineCode",{parentName:"p"},"AKT")," portion of the LP share to receive 100% OSMO in the ",(0,n.kt)("strong",{parentName:"p"},"minimum")," amount of ",(0,n.kt)("inlineCode",{parentName:"p"},".298548 OSMO"),":"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd tx gamm exit-swap-share-amount-in uosmo 14563185400026723131 298548 --pool-id 3 --from WALLET_NAME --chain-id osmosis-1\n")),(0,n.kt)("p",null,":::"),(0,n.kt)("h3",{id:"swap-exact-amount-in"},"Swap-exact-amount-in"),(0,n.kt)("p",null,"Swap an ",(0,n.kt)("strong",{parentName:"p"},"exact")," amount of tokens for a ",(0,n.kt)("strong",{parentName:"p"},"minimum")," of another token, similar to swapping a token on the trade screen GUI."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd tx gamm swap-exact-amount-in [token-in] [token-out-min-amount] --pool-id --from --chain-id\n")),(0,n.kt)("p",null,"::: details Example"),(0,n.kt)("p",null,"Swap ",(0,n.kt)("strong",{parentName:"p"},"exactly")," ",(0,n.kt)("inlineCode",{parentName:"p"},".407239 AKT")," through ",(0,n.kt)("inlineCode",{parentName:"p"},"pool 3")," into a ",(0,n.kt)("strong",{parentName:"p"},"minimum")," of ",(0,n.kt)("inlineCode",{parentName:"p"},".140530 OSMO")," using ",(0,n.kt)("inlineCode",{parentName:"p"},"WALLET_NAME")," on the osmosis mainnet:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd tx gamm swap-exact-amount-in 407239ibc/1480B8FD20AD5FCAE81EA87584D269547DD4D436843C1D20F15E00EB64743EF4 140530 --swap-route-pool-ids 3 --swap-route-denoms uosmo --from WALLET_NAME --chain-id osmosis-1\n")),(0,n.kt)("p",null,":::"),(0,n.kt)("h3",{id:"swap-exact-amount-out"},"Swap-exact-amount-out"),(0,n.kt)("p",null,"Swap a ",(0,n.kt)("strong",{parentName:"p"},"maximum")," amount of tokens for an ",(0,n.kt)("strong",{parentName:"p"},"exact")," amount of another token, similar to swapping a token on the trade screen GUI."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd tx gamm swap-exact-amount-out [token-out] [token-out-max-amount] --swap-route-pool-ids --from --chain-id\n")),(0,n.kt)("p",null,"::: details Example"),(0,n.kt)("p",null,"Swap a ",(0,n.kt)("strong",{parentName:"p"},"maximum")," of ",(0,n.kt)("inlineCode",{parentName:"p"},".407239 AKT")," through ",(0,n.kt)("inlineCode",{parentName:"p"},"pool 3")," into ",(0,n.kt)("strong",{parentName:"p"},"exactly")," ",(0,n.kt)("inlineCode",{parentName:"p"},".140530 OSMO")," using ",(0,n.kt)("inlineCode",{parentName:"p"},"WALLET_NAME")," on the osmosis mainnet:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd tx gamm swap-exact-amount-out 140530uosmo 407239 --swap-route-pool-ids 3 --swap-route-denoms ibc/1480B8FD20AD5FCAE81EA87584D269547DD4D436843C1D20F15E00EB64743EF4 --from WALLET_NAME --chain-id osmosis-1\n")),(0,n.kt)("p",null,":::"),(0,n.kt)("h2",{id:"queries"},"Queries"),(0,n.kt)("h2",{id:"queries-1"},"Queries"),(0,n.kt)("p",null,"The ",(0,n.kt)("strong",{parentName:"p"},"Query")," submodule of the GAMM module provides the logic to request information from the liquidity pools. It contains the following functions:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#estimate-swap-exact-amount-in"},"Estimate Swap Exact Amount In")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#estimate-swap-exact-amount-out"},"Estimate Swap Exact Amount Out")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#num-pools"},"Num Pools")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#pool"},"Pool")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#pool-assets"},"Pool Assets")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#pool-params"},"Pool Params")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#pools"},"Pools")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#spot-price"},"Spot Price")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#total-liquidity"},"Total Liquidity")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#total-share"},"Total Share"))),(0,n.kt)("h3",{id:"estimate-swap-exact-amount-in"},"Estimate Swap Exact Amount In"),(0,n.kt)("p",null,"Query the estimated result of the ",(0,n.kt)("a",{parentName:"p",href:"#swap-exact-amount-in"},"Swap Exact Amount In")," transaction. Note that the flags ",(0,n.kt)("em",{parentName:"p"},"swap-route-pool")," and ",(0,n.kt)("em",{parentName:"p"},"swap-route-denoms")," are required."),(0,n.kt)("h4",{id:"usage"},"Usage"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query gamm estimate-swap-exact-amount-in <poolID> <sender> <tokenIn> [flags]\n")),(0,n.kt)("h4",{id:"example"},"Example"),(0,n.kt)("p",null,"Query the amount of ATOM the sender would receive for swapping 1 OSMO in pool 1."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query gamm estimate-swap-exact-amount-in 1 osmo123nfq6m8f88m4g3sky570unsnk4zng4uqv7cm8 1000000uosmo --swap-route-pool-ids 1 --swap-route-denoms ibc/27394FB092D2ECCD56123C74F36E4C1F926001CEADA9CA97EA622B25F41E5EB2 \n")),(0,n.kt)("h3",{id:"estimate-swap-exact-amount-out"},"Estimate Swap Exact Amount Out"),(0,n.kt)("p",null,"Query the estimated result of the ",(0,n.kt)("a",{parentName:"p",href:"#swap-exact-amount-out"},"Swap Exact Amount Out")," transaction. Note that the flags ",(0,n.kt)("em",{parentName:"p"},"swap-route-pool")," and ",(0,n.kt)("em",{parentName:"p"},"swap-route-denoms")," are required."),(0,n.kt)("h4",{id:"usage-1"},"Usage"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query gamm estimate-swap-exact-amount-out <poolID> <sender> <tokenOut> [flags]\n")),(0,n.kt)("h4",{id:"example-1"},"Example"),(0,n.kt)("p",null,"Query the amount of OSMO the sender would require to swap 1 ATOM out of pool 1."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query gamm estimate-swap-exact-amount-out 1 osmo123nfq6m8f88m4g3sky570unsnk4zng4uqv7cm8 1000000ibc/27394FB092D2ECCD56123C74F36E4C1F926001CEADA9CA97EA622B25F41E5EB2 --swap-route-pool-ids 1 --swap-route-denoms uosmo\n")),(0,n.kt)("h3",{id:"num-pools"},"Num Pools"),(0,n.kt)("p",null,"Query the number of active pools."),(0,n.kt)("h4",{id:"usage-2"},"Usage"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query gamm num-pools\n")),(0,n.kt)("h2",{id:"pool-1"},"Pool"),(0,n.kt)("p",null,"Query the parameter and assets of a specific pool."),(0,n.kt)("h3",{id:"usage-3"},"Usage"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query gamm pool <poolID> [flags]\n")),(0,n.kt)("h3",{id:"example-2"},"Example"),(0,n.kt)("p",null,"Query parameters and assets from pool 1."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query gamm pool 1\n")),(0,n.kt)("h3",{id:"pool-assets"},"Pool Assets"),(0,n.kt)("p",null,"Query the assets of a specific pool. This query is a reduced form of the ",(0,n.kt)("a",{parentName:"p",href:"#pool"},"Pool")," query."),(0,n.kt)("h4",{id:"usage-4"},"Usage"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query gamm pool-assets <poolID> [flags]\n")),(0,n.kt)("h4",{id:"example-3"},"Example"),(0,n.kt)("p",null,"Query the assets from pool 1."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query gamm pool-assets 1\n")),(0,n.kt)("h3",{id:"pool-params"},"Pool Params"),(0,n.kt)("p",null,"Query the parameters of a specific pool. This query is a reduced form of the ",(0,n.kt)("a",{parentName:"p",href:"#pool"},"Pool")," query."),(0,n.kt)("h4",{id:"usage-5"},"Usage"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query gamm pool-params <poolID> [flags]\n")),(0,n.kt)("p",null,"Query the parameters from pool 1."),(0,n.kt)("h4",{id:"example-4"},"Example"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query gamm pool-params 1\n")),(0,n.kt)("h3",{id:"pools"},"Pools"),(0,n.kt)("p",null,"Query parameters and assets of all active pools."),(0,n.kt)("h4",{id:"usage-6"},"Usage"),(0,n.kt)("p",null,"Query the price of OSMO based on the price of ATOM in pool 1."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query gamm spot-price 1 uosmo ibc/27394FB092D2ECCD56123C74F36E4C1F926001CEADA9CA97EA622B25F41E5EB2\n")),(0,n.kt)("h3",{id:"total-liquidity"},"Total Liquidity"),(0,n.kt)("p",null,"Query the total liquidity of all active pools."),(0,n.kt)("h4",{id:"usage-7"},"Usage"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query gamm total-liquidity\n")),(0,n.kt)("h3",{id:"total-share"},"Total Share"),(0,n.kt)("p",null,"Query the total amount of GAMM shares of a specific pool."),(0,n.kt)("h4",{id:"usage-8"},"Usage"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query gamm total-share <poolID> [flags]\n")),(0,n.kt)("h4",{id:"example-5"},"Example"),(0,n.kt)("p",null,"Query the total amount of GAMM shares of pool 1."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd query gamm total-share 1\n")),(0,n.kt)("h2",{id:"other-resources"},"Other resources"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/osmosis-core/modules/gamm/client/docs/create-lbp-pool"},"Creating a liquidity bootstrapping pool")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/osmosis-core/modules/gamm/client/docs/create-pool"},"Creating a pool with a pool file"))),(0,n.kt)("h2",{id:"events"},"Events"),(0,n.kt)("p",null,"There are 5 types of events that exist in GAMM:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"sdk.EventTypeMessage"),' - "message"'),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"types.TypeEvtPoolJoined"),' - "pool_joined"'),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"types.TypeEvtPoolExited"),' - "pool_exited"'),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"types.TypeEvtPoolCreated"),' - "pool_created"'),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"types.TypeEvtTokenSwapped"),' - "token_swapped"')),(0,n.kt)("h3",{id:"sdkeventtypemessage"},(0,n.kt)("inlineCode",{parentName:"h3"},"sdk.EventTypeMessage")),(0,n.kt)("p",null,"This event is emitted in the message server when any of the gamm messages finish execution."),(0,n.kt)("h3",{id:"typestypeevtpooljoined"},(0,n.kt)("inlineCode",{parentName:"h3"},"types.TypeEvtPoolJoined")),(0,n.kt)("p",null,"This event is emitted after one of ",(0,n.kt)("inlineCode",{parentName:"p"},"JoinPool")," or ",(0,n.kt)("inlineCode",{parentName:"p"},"JoinPoolNoSwap")," complete joining\nthe requested pool successfully."),(0,n.kt)("p",null,"It consists of the following attributes:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"sdk.AttributeKeyModule"),' - "module"',(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},'The value is the module\'s name - "gamm".'))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"sdk.AttributeKeySender"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"The value is the address of the sender who created the swap message."))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"types.AttributeKeyPoolId"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"The value is the pool id of the pool where swap occurs."))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"types.AttributeKeyTokensIn"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"The value is the string representation of the tokens being swapped in.")))),(0,n.kt)("h3",{id:"typestypeevtpoolexited"},(0,n.kt)("inlineCode",{parentName:"h3"},"types.TypeEvtPoolExited")),(0,n.kt)("p",null,"This event is emitted after ",(0,n.kt)("inlineCode",{parentName:"p"},"ExitPool")," completes exiting\nthe requested pool successfully."),(0,n.kt)("p",null,"It consists of the following attributes:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"sdk.AttributeKeyModule"),' - "module"',(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},'The value is the module\'s name - "gamm".'))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"sdk.AttributeKeySender"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"The value is the address of the sender who created the swap message."))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"types.AttributeKeyPoolId"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"The value is the pool id of the pool where swap occurs."))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"types.AttributeKeyTokensOut"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"The value is the string representation of the tokens being swapped out.")))),(0,n.kt)("h3",{id:"typestypeevtpoolcreated"},(0,n.kt)("inlineCode",{parentName:"h3"},"types.TypeEvtPoolCreated")),(0,n.kt)("p",null,"This event is emitted after ",(0,n.kt)("inlineCode",{parentName:"p"},"CreatePool")," completes creating\nthe requested pool successfully."),(0,n.kt)("h3",{id:"typestypeevttokenswapped"},(0,n.kt)("inlineCode",{parentName:"h3"},"types.TypeEvtTokenSwapped")),(0,n.kt)("p",null,"This event is emitted after one of ",(0,n.kt)("inlineCode",{parentName:"p"},"SwapExactAmountOut")," or ",(0,n.kt)("inlineCode",{parentName:"p"},"SwapExactAmountIn")," updates\npool state successfully."),(0,n.kt)("p",null,"It consists of the following attributes:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"sdk.AttributeKeyModule"),' - "module"',(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},'The value is the module\'s name - "gamm".'))),(0,n.kt)("li",{parentName:"ul"},"sdk.AttributeKeySender",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"The value is the address of the sender who created the swap message."))),(0,n.kt)("li",{parentName:"ul"},"types.AttributeKeyPoolId",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"The value is the pool id of the pool where swap occurs."))),(0,n.kt)("li",{parentName:"ul"},"types.AttributeKeyTokensIn",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"The value is the string representation of the tokens being swapped in."))),(0,n.kt)("li",{parentName:"ul"},"types.AttributeKeyTokensOut",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"The value is the string representation of the tokens being swapped out.")))))}u.isMDXComponent=!0}}]);